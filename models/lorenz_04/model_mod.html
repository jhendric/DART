<HTML>
<HEAD>
<TITLE>module model_mod (Lorenz_04)</TITLE>
<link rel="stylesheet" type="text/css" href="../../doc/html/doc.css"></link> 
</HEAD>
<BODY>
<!--
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!                                                                       !!
!!                   GNU General Public License                          !!
!!                                                                       !!
!! This file is part of the Data Assimilation Research Testbed (DART).   !!
!!                                                                       !!
!! DART is free software; you can redistribute it and/or modify          !!
!! it and are expected to follow the terms of the GNU General Public     !!
!! License as published by the Free Software Foundation.                 !!
!!                                                                       !!
!! DART is distributed in the hope that it will be useful,               !!
!! but WITHOUT ANY WARRANTY; without even the implied warranty of        !!
!! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         !!
!! GNU General Public License for more details.                          !!
!!                                                                       !!
!! You should have received a copy of the GNU General Public License     !!
!! along with DART; if not, write to:                                    !!
!!          Free Software Foundation, Inc.                               !!
!!          59 Temple Place, Suite 330                                   !!
!!          Boston, MA  02111-1307  USA                                  !!
!! or see:                                                               !!
!!          http://www.gnu.org/licenses/gpl.txt                          !!
!!                                                                       !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-->

<DIV ALIGN="CENTER">
<A HREF="#Interface">INTERFACE</A> / 
<A HREF="#PublicEntities">PUBLIC COMPONENTS</A> / 
<A HREF="#Namelist">NAMELIST</A> / 
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#KnownBugs">BUGS</A> /
<A HREF="#FuturePlans">PLANS</A>
</DIV>

<!--==================================================================-->

<H1>MODULE model_mod (Lorenz_04)</H1>
<A NAME="HEADER"></A>
<TABLE summary="">
<TR><TD>Contact:       </TD><TD> Jeff Anderson     </TD></TR>
<TR><TD>Revision:      </TD><TD> $Revision$ </TD></TR>
<TR><TD>Source:        </TD><TD> $URL$ </TD></TR>
<TR><TD>Change Date:   </TD><TD> $Date$ </TD></TR>
<TR><TD>Change history:</TD><TD> try "svn log" or "svn diff" </TD></TR>
</TABLE>

<!--==================================================================-->

<A NAME="OVERVIEW"></A>
<HR>
<H2>OVERVIEW</H2>

<P>
DART interface module for the Lorenz-05 models II and III. 
The 17 public interfaces
are standardized for all DART compliant models. These interfaces allow
DART to advance the model, get the model state and metadata describing 
this state, find state variables that are close to a given location, 
and do spatial interpolation for model state variables.
</P>

<P>The reference for these models is Lorenz, E.N., 2005: Designing
chaotic models. <span style="font-style: italic;">J. Atmos. Sci.</span>,
<span style="font-weight: bold;">62</span>, 1574-1587.<br>
</P>

<P>Model II is a single-scale model, similar to Lorenz 96, but with
spatial continuity in the waves. Model III is a two-scale
model. It is fudamentally different from the Lorenz 96 two-scale
model because of the spatial continuity and the fact that both scales
are projected onto a single variable of integration. The scale
separation is achived by a spatial filter and is therefore not perfect
(i.e. there is leakage). The slow scale in model III is model II,
and thus model II is a deficient form of model III. The basic
equations are documented in Lorenz (2005) and also in the model_mod.f90
code. The user is free to choose model II or III with a Namelist
variable.<br>
</P>

<!--==================================================================-->

<A NAME="OTHER MODULES USED"></A>
<BR><HR><BR>
<H2>OTHER MODULES USED</H2>
<PRE>
types_mod
time_manager_mod
oned/location_mod
utilities_mod
</PRE>

<!--==================================================================-->
<!--Note to authors. The first row of the table is different.         -->

<A NAME="Interface"></A>
<BR><HR><BR>
<H2>PUBLIC INTERFACE</H2>

<TABLE>
<TR><TD><em class=call>use model_mod, only : </em></TD>
                   <TD><A HREF="#yyyroutine1">get_model_size</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine2">adv_1step</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine3">get_state_meta_data</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine4">model_interpolate</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine5">get_model_time_step</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine6">end_model</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine7">static_init_model</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine8">init_time</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine9">init_conditions</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine11">nc_write_model_atts</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine12">nc_write_model_vars</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine13">nc_read_model_vars</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine14">pert_model_state</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#get_close_maxdist_init">get_close_maxdist_init</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#get_close_obs_init">get_close_obs_init</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#get_close_obs">get_close_obs</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#ens_mean_for_model">ens_mean_for_model</A></TD></TR>
</TABLE>

<H3 class="indent1">NOTES</H3>

<P>
Optional namelist interface
<A HREF="#Namelist"> <em class=code>&#38;model_nml</em> </A>
may be read from file <em class=file>input.nml</em>.
</P>

<!--==================================================================-->
<!-- Declare all public entities ...                                  -->
<!-- duplicate public routines template as many times as necessary    -->
<!-- make sure you replace all yyyroutine?? strings                   -->
<!--==================================================================-->

<A NAME="PublicEntities"></A>
<BR><HR><BR>
<h2>PUBLIC COMPONENTS</h2>
<p>Public routines in this model are:</p>

<!--===================== DESCRIPTION OF FUNCTION =====================-->

<A NAME="yyyroutine1"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">var = get_model_size( )</em>
<pre>
integer                               :: <em class="code">var</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Returns the length of the model state vector as an integer.
Settable by namelist, the default is 960.
</P>

<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine2"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">call adv_1step(x, time)</em>
<pre>
real(r8), dimension(:),   intent(inout) :: <em class="code">x</em>
type(time_type),          intent(in)    :: <em class="code">time</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Advances a model for a single time step using a four-step Runga-Kutta.
The time argument is passed in but not used by this model.
</P>
<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
    <TR><TD valign="top"><em class="code">x</em></TD>
        <TD>State vector of length model_size.  </TD></TR>
    <TR><TD valign="top"><em class="code">time</em></TD>
        <TD>Gives time of the initial model state. Not used by 
            this model.</TD></TR>
</tbody>
</TABLE>

<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine3"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">call get_state_meta_data(index_in, location,
                          <em class="optionalcode">[,var_type]</em> )</em>
<pre>
integer,                  intent(in)    :: <em class="code"> index_in </em>
type(location_type),      intent(out)   :: <em class="code"> location </em>
integer, optional,        intent(out)   :: <em class="optionalcode"> var_type </em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Returns metadata about a given element, indexed by index_in, in the
model state vector. The location defines where the state variable is
located (at present, a variety of simple location models for support of
gridpoint models are provided) while the type of the variable (for
instance temperature, or u wind component) is returned by var_type. 
In this model there are no types so it always returns 1.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">index_in</em></TD>
    <TD>Index into the state vector.</TD></TR>

<TR><TD valign="top"><em class="code">location</em></TD>
    <TD>Returns location of indexed state variable</TD></TR>

<TR><TD valign="top"><em class="optionalcode">var_type</em></TD>
    <TD>If present always returns 1</TD></TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>

<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine4"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">call model_interpolate(x, location, itype, obs_val, istatus)</em>
<pre>
real(r8), dimension(:),   intent(in)  :: <em class="code"> x </em>
type(location_type),      intent(in)  :: <em class="code"> location </em>
integer,                  intent(in)  :: <em class="code"> itype </em>
real(r8),                 intent(out) :: <em class="code"> obs_val </em>
integer,                  intent(out) :: <em class="code"> istatus </em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Given model state, returns the value of variable itype interpolated
to a given location.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">x</em></TD>
    <TD>Model state vector. </TD></TR>

<TR><TD valign="top"><em class="code">location</em></TD>
    <TD>Location to which to interpolate.</TD></TR>

<TR><TD valign="top"><em class="code">itype</em></TD>
    <TD>Integer indexing which type of state variable is to be 
        interpolated. Is ignored for this model since there
        is only a single type of variable.</TD></TR>

<TR><TD valign="top"><em class="code">obs_val</em></TD>
    <TD>The value of the observation from the model.</TD></TR>

<TR><TD valign="top"><em class="code">istatus</em></TD>
    <TD>Quality control information about the observation of 
        the model state. 0 == successful.</TD></TR>

</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>

<!--===================== DESCRIPTION OF FUNCTION =====================-->

<A NAME="yyyroutine5"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">var = get_model_time_step( )</em>
<pre>
type(time_type)                       :: <em class="code">var</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Returns the model time_step, which is settable by namelist.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">var</em></TD>
    <TD>The base time step of the model. The forecast length.</TD></TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>


<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine6"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">call end_model( )</em>
<pre></pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
A stub routine in this model.
</P>

<H3 class="indent1">Notes</H3>

<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine7"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">call static_init_model( )</em>
<pre></pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Reads the namelist, allocates space for the state vector,
initializes the locations, generates some initial parameters.
</P>

<H3 class="indent1">Notes</H3>

<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine8"></A>
<BR><HR><BR>
<div class="routine">
<em class="call">call init_time(time) </em>
<pre>type(time_type),          intent(in)    :: <em class="code">time</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Returns the time at which the model will start if no input initial
conditions are to be used.  This model sets initial time to 0.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">time</em></TD>
    <TD>The time at which the model will start if no input initial
        conditions are to be used.</TD></TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>

<!--===================== DESCRIPTION OF SUBROUTINE =====================-->
<A NAME="yyyroutine9"></A>
<BR><HR><BR> 
<div class="routine">
<em class="call">call init_conditions( x )</em>
<pre>real(r8), dimension(:),   intent(out)   :: <em class="code">x</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Sets the entire state variable to the value of the forcing and then
slightly perturbs the first element.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">x</em></TD>
    <TD>Model state vector.</TD></TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>


<!--===================== DESCRIPTION OF FUNCTION =====================-->

<A NAME="yyyroutine11"></A>
<BR><HR><BR> 
<div class="routine">
<em class="call">ierr = nc_write_model_atts(ncFileId)</em>
<pre>
integer,                              :: <em class="code">ierr</em>
integer,                  intent(in)  :: <em class="code">ncFileId</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Function to write model specific attributes to a netCDF file.
This function writes the metadata
associated with the model to a NetCDF file opened to a file identified
by ncFileID.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">ncFileId &nbsp; &nbsp; </em></TD>
    <TD>Integer file descriptor opened to NetCDF file.</TD>
</TR>
<TR><TD valign="top"><em class="code">ierr</em></TD>
    <TD>Returned error code. 0 == normal termination</TD>
</TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>

<!--===================== DESCRIPTION OF FUNCTION =====================-->

<A NAME="yyyroutine12"></A>
<BR><HR><BR> 
<div class="routine">
<em class="call"> ierr = nc_write_model_vars(ncFileID, statevec, copyindex, timeindex)</em>
<pre>
integer                               :: <em class="code">ierr</em>
integer,                  intent(in)  :: <em class="code">ncFileID</em>
real(r8), dimension(:),   intent(in)  :: <em class="code">statevec</em>
integer,                  intent(in)  :: <em class="code">copyindex</em>
integer,                  intent(in)  :: <em class="code">timeindex</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Writes a copy of the state variables to a NetCDF file. Multiple copies
of the state for a given time are supported, allowing, for instance, a
single file to include multiple ensemble estimates of the state.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">ncFileID &nbsp; &nbsp;</em></TD>
    <TD>Integer file descriptor connected to NetCDF file.</TD></TR>
<TR><TD valign="top"><em class="code">statevec</em></TD>
    <TD>State vector.</TD></TR>
<TR><TD valign="top"><em class="code">copyindex</em></TD>
    <TD> Integer index to which copy in the file is to be written. </TD></TR>
<TR><TD valign="top"><em class="code">timeindex</em></TD>
    <TD>Integer index of which time in the file is being written.</TD></TR>
<TR><TD valign="top"><em class="code">ierr</em></TD>
    <TD>Returned error code. 0 == normal termination.</TD></TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>

<!--===================== DESCRIPTION OF FUNCTION =====================-->

<A NAME="yyyroutine13"></A>
<BR><HR><BR> 
<div class="routine">
<em class="call"> ierr = nc_read_model_vars(ncFileID, statevec, copyindex, timeindex)</em>
<pre>
integer                               :: <em class="code">ierr</em>
integer,                  intent(in)  :: <em class="code">ncFileID</em>
real(r8), dimension(:),   intent(out) :: <em class="code">statevec</em>
integer,                  intent(in)  :: <em class="code">copyindex</em>
integer,                  intent(in)  :: <em class="code">timeindex</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>
<P>
A general interface routine to read the state vector at a particular time for a 
particular ensemble member.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">ierr</em></TD>
    <TD>Returned error code. 0 == normal termination.</TD></TR>
<TR><TD valign="top"><em class="code">ncFileID &nbsp; &nbsp;</em></TD>
    <TD>Integer file descriptor connected to NetCDF file.</TD></TR>
<TR><TD valign="top"><em class="code">statevec</em></TD>
    <TD>State vector.</TD></TR>
<TR><TD valign="top"><em class="code">copyindex</em></TD>
    <TD>Integer index to designate copy to be read.</TD></TR>
<TR><TD valign="top"><em class="code">timeindex</em></TD>
    <TD>Integer index of desired time to be read.</TD></TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>
<P>
This interface is essentially untested in the Lorenz 04/05 model. It began life
as a stub, but there is so little to it ... TJH&nbsp;05&nbsp;Aug&nbsp;2005.
</P>

<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine14"></A>
<BR><HR><BR> 
<div class="routine">
<em class="call">call pert_model_state(state, pert_state, interf_provided)</em>
<pre>
real(r8), dimension(:),   intent(in)    :: <em class="code">state</em>
real(r8), dimension(:),   intent(out)   :: <em class="code">pert_state</em>
logical,                  intent(out)   :: <em class="code">interf_provided</em>
</pre>
</DIV>

<H3 class="indent1">Description</H3>

<P>
Given a model state, produces a perturbed model state. This is used to
generate initial ensemble conditions perturbed around some control
trajectory state when one is preparing to spin-up ensembles. A DART
compliant model can choose not to provide an implementation of this
algorithm and use the default mechanism in DART by simply returning
.false. as a returned value for the interf_provided argument. In this
case, DART perturbs the state to generate ensemble members by adding a
random sample from a N(0.0, 0.002) distribution independently to each
state variable. This model returns .false. for interf_provided and
uses the default DART perturbation routine.
</P>

<TABLE summary="" border="0" cellpadding="3" width="100%">
<tbody>
<TR><TD valign="top"><em class="code">state</em></TD>
    <TD>State vector to be perturbed</TD></TR>
<TR><TD valign="top"><em class="code">pert_state</em></TD>
    <TD>Perturbed state vector is returned</TD></TR>
<TR><TD valign="top"><em class="code">interf_provided</em></TD>
    <TD>Returns false to have DART perturb state</TD></TR>
</tbody>
</TABLE>

<H3 class="indent1">Notes</H3>
<P>
The Lorenz 04/05 model relies implicitly on the default DART perturbation 
mechanism, i.e. this routine always returns <em class="code">.false.</em>.
</P>

<!--=================================================================-->
<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="get_close_maxdist_init"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call get_close_maxdist_init(gc, maxdist) </em>
 <pre>
 type(get_close_type), intent(inout) :: <em class=code>gc</em>
 real(r8),             intent(in)    :: <em class=code>maxdist</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Pass-through to the 1-D locations module. See
<A HREF="../../location/oned/location_mod.html#get_close_maxdist_init">
get_close_maxdist_init()</A> for the documentation of this subroutine.

<!--=================================================================-->
<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="get_close_obs_init"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call get_close_obs_init(gc, num, obs) </em>
 <pre>
 type(get_close_type), intent(inout) :: <em class=code>gc</em>
 integer,              intent(in)    :: <em class=code>num</em>
 type(location_type),  intent(in)    :: <em class=code>obs(num)</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Pass-through to the 1-D locations module. See
<A HREF="../../location/oned/location_mod.html#get_close_obs_init">
get_close_obs_init()</A> for the documentation of this subroutine.

<!--=================================================================-->
<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="get_close_obs"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call get_close_obs(gc, base_obs_loc, base_obs_kind, 
   obs, obs_kind, num_close, close_ind
   <em class=code>[, dist]</em>) </em>
 <pre>
 type(get_close_type), intent(in)  :: <em class=code>gc</em>
 type(location_type),  intent(in)  :: <em class=code>base_obs_loc</em>
 integer,              intent(in)  :: <em class=code>base_obs_kind</em>
 type(location_type),  intent(in)  :: <em class=code>obs(:)</em>
 integer,              intent(in)  :: <em class=code>obs_kind(:)</em>
 integer,              intent(out) :: <em class=code>num_close</em>
 integer,              intent(out) :: <em class=code>close_ind(:)</em>
 real(r8), optional,   intent(out) :: <em class=optionalcode>dist(:)</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Pass-through to the 1-D locations module. See
<A HREF="../../location/oned/location_mod.html#get_close_obs">
get_close_obs()</A> for the documentation of this subroutine.

<!--=================================================================-->
<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="ens_mean_for_model"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call ens_mean_for_model(ens_mean) </em>
 <pre>
 real(r8), dimension(:), intent(in)  :: <em class=code>ens_mean</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
A NULL INTERFACE in this model.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>ens_mean&nbsp; &nbsp; </em></TD>
     <TD>Ensemble mean state vector</TD></TR>
 </TABLE>
 <BR>

<!--==================================================================-->
<!--=================== DESCRIPTION OF A NAMELIST  ===================-->
<!--==================================================================-->

<A NAME="Namelist"></A>
<BR><HR><BR>
<H2>NAMELIST</H2>

<P>
We adhere to the F90 standard of starting A NAMElist with an
ampersand '&amp;' and terminating with a slash '/'. If the namelist extends
over more than one F90 line, the F90 continuation character must be used,
this is also an ampersand (just to confuse things).
<div class="namelist">
<pre>
<em class="call">namelist / model_nml / </em>      &amp;
   model_size, forcing, delta_t, space_time_scale, &amp;
   coupling, K, smooth_steps,                      &amp;
   time_step_days, time_step_seconds, model_number
</pre>
</DIV>
</P>

<H3 class=indent1>Discussion</H3>

<P>This namelist is read in a file called <em class=file>input.nml</em>
</P>

<TABLE border="0" cellpadding="3" width="100%">
<tbody>
<TR><th align="left">Contents    </th>
    <th align="left">Type        </th>
    <th align="left">Description </th></TR>

<TR><!--contents--><TD valign="top">model_size         </TD>
    <!--  type  --><TD valign="top">integer            </TD>
    <!--descript--><TD>Number of variables in model, default is 960. </TD></TR>

<TR><!--contents--><TD valign="top">forcing            </TD>
    <!--  type  --><TD valign="top">real(r8)           </TD>
    <!--descript--><TD>Forcing, F, for model, default 15.0 </TD> </TR>

<TR><!--contents--><TD valign="top">delta_t            </TD>
    <!--  type  --><TD valign="top">real(r8)           </TD>
    <!--descript--><TD>Non-dimensional timestep, default 0.001</TD> </TR>

<TR><!--contents--><TD valign="top">space_time_scale   </TD>
    <!--  type  --><TD valign="top">real(r8)           </TD>
    <!--descript--><TD>Determines temporal and spatial relationship between
        fast and slow variables (model III), default 10.0     </TD></TR>

<TR><!--contents--><TD valign="top">coupling           </TD>
    <!--  type  --><TD valign="top">real(r8)           </TD>
    <!--descript--><TD>Linear coupling between fast and slow variables 
        (model III), default 3.0                       </TD></TR>

<TR><!--contents--><TD valign="top">K                  </TD>
    <!--  type  --><TD valign="top">integer            </TD>
    <!--descript--><TD>Determines the wavenumber of the slow variables 
        (K=1, smooth_steps=0 reduces model II to Lorenz 96), default 32</TD></TR>

<TR><!--contents--><TD valign="top">smooth_steps       </TD>
    <!--  type  --><TD valign="top">integer            </TD>
    <!--descript--><TD>Determines filter length to separate fast and 
        slow scales, default 12                        </TD></TR>

<TR><!--contents--><TD valign="top">time_step_days     </TD>
    <!--  type  --><TD valign="top">integer            </TD>
    <!--descript--><TD>Arbitrary real time step days, default 0</TD></TR>

<TR><!--contents--><TD valign="top">time_step_seconds  </TD>
    <!--  type  --><TD valign="top">integer            </TD>
    <!--descript--><TD>Arbitrary real time step seconds (could choose this
        for proper scaling), default 3600              </TD></TR>

<TR><!--contents--><TD valign="top">model_number       </TD>
    <!--  type  --><TD valign="top">integer            </TD>
    <!--descript--><TD>2 = single-scale, 3 = 2-scale.
                (This follows the notation in the paper.) default 3</TD></TR>

</tbody>
</TABLE>

<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<BR><HR><BR>
<H2>FILES</H2>
<UL> 
    <LI>model_mod.nml in input.nml</LI>
    <LI>netCDF output state diagnostics files</LI>
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<BR><HR><BR>
<H2>REFERENCES</H2>

<P>The reference for these models is Lorenz, E.N., 2005: Designing
chaotic models. <span style="font-style: italic;">J. Atmos. Sci.</span>,
<span style="font-weight: bold;">62</span>, 1574-1587.<br>
</P>

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!-- Putting a <BR> after the synopsis creates a nice effect.         -->
<!--==================================================================-->

<A NAME="Errors"></A>
<HR>
<H2>ERROR CODES and CONDITIONS</H2>
<div class="errors">

<TABLE border=1 cellspacing=1 cellpadding=10 width=100%>
<TR><TH>Routine</TH><TH>Message</TH><TH>Comment</TH></TR>
<TR><!-- routine --><TD VALIGN=top>nc_write_model_atts <BR>
                                   nc_write_model_vars <BR></TD>
    <!-- message --><TD VALIGN=top>Various NetCDF-f90 interface error messages</TD>
    <!-- comment --><TD VALIGN=top>From one of the NetCDF calls in the named routine</TD>
</TR>
</TABLE>
</DIV>

<!--==================================================================-->
<!-- Describe the bugs.                                               -->
<!--==================================================================-->

<A NAME="KnownBugs"></A>
<BR><HR><BR>
<H2>KNOWN BUGS</H2>
<P>
</P>

<!--==================================================================-->
<!-- Descibe Future Plans.                                            -->
<!--==================================================================-->

<A NAME="FuturePlans"></A>
<BR><HR><BR>
<H2>FUTURE PLANS</H2>
<P>
</P>

<!--==================================================================-->
<!-- Have not fleshed out this part yet ... ha ha ha                  -->
<!--==================================================================-->

<HR>
</BODY>
</HTML>
