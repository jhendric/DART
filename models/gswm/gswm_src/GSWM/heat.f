       SUBROUTINE HEAT(XH,Z,VLAT,Q)
       
       REAL UVMAX(5),EUVMAX(5)

       DIMENSION Q(3,2)

      COMMON /MODEi/NZONAL,MOIS,NSS
      COMMON /MODEr/PERIOD,FREQ,FLUX
C       COMMON/MINMAX/NSS

C      FRAC1,FRAC2=FRACTION OF TOTAL HEATING GOING INTO DIURNAL AND
C      SEMIDIURNAL COMPONENTS, RESPECTIVELY
C      Q=JOULE/M3/SEC
C      THERMOSPHERIC HEATING (UV AND EUV)

      DATA XA,XB,XC,XD/2.25,1.1,6.75,.65/
      DATA (UVMAX(I),I=1,5)/5*.75E-7/
      DATA (EUVMAX(I),I=1,5)/9.42E-9,9.536E-9,9.768E-9,1.00E-8,
     11.029E-8/
      DATA UV,EUV,FRAC1,FRAC2/1.0,1.0,.5,.18/
       
       X=XH-13.9
       Q(1,1)=0.0
       Q(1,2)=0.0
       Q(2,2)=0.0
       Q(3,1)=0.0
       Q(3,2)=0.0
       IF (Z.LE.85.) GO TO 30
3      X1=(X-XA)/XB
       X2=(X-XC)/XD
       ZENITH=ABS(VLAT)
       SEC=1./COS(ZENITH)
       FUV=EXP(1.-X1-SEC*EXP(-X1))
       FEUV=EXP(1.-X2-SEC*EXP(-X2))
       IF(X.LT.6.) GO TO 87
       SECC=1
       GO TO 88
87     SECC=SEC
88     QUV=SECC*UVMAX(NSS)*FUV
       IF(X.LE.8.) GO TO 99
       SEC=2.*SEC
99     QEUV=SEC*EUVMAX(NSS)*FEUV
       QT=(UV*QUV+EUV*QEUV)
       Q(1,2)=FRAC1*QT
       Q(2,2)=FRAC2*QT
       Q(3,2)=0.0
30     RETURN
       END
