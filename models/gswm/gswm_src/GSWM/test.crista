	program test
C_________________________________________________________________________

C  This subroutine reads in arrays of O3 from CIRA (1991) provided by Keating
C            17 latitudes: 80 to -80 in steps of 10 degrees
C    27 altitudes
C
C  The densities are stored in the array dO3(17,27).  Subsequently, the elements
C  of dO3 are converted from units of ppmv to number densities.
C    N.B., [O3] = 2.079E+19*RHO(kg m-3)*O3(ppmv)     
C
C  The array of altitudes, zO3(17,27) is calculated using the output of
C  setatmos.  This array defines the altitudes which correspond to each
C  element of dO3(17,27) 

C  Modified to read in CRISTA background O3 vs. altitude      M.Hagan (6/28/99)
C_________________________________________________________________________

      character*10 ochoice1(12)
      character*10 ofile

      integer x1O3(17),ialt(27)

      real xO3(17)
      real diO3(17,27)

	data rs,bc,poo,go/8.31432,1.38054e-23,1.01325e+05,9.80665/
	data re,omega/6356766.,.72722e-04/

      data ochoice1/'ciraO3_jan','ciraO3_feb','ciraO3_mar',
     +             'ciraO3_apr','ciraO3_may','ciraO3_jun',
C    +             'ciraO3_jul','ciraO3_aug','ciraO3_sep',
C    +             'ciraO3_oct','ciraO3_nov','ciraO3_dec'/
     +             'ciraO3_jul','criso3_aug','ciraO3_sep',
     +             'ciraO3_oct','criso3_nov','ciraO3_dec'/

	mois=8
        ofile=ochoice1(mois)
cc
      print*,'SETHEAT: ofile= ',ofile
c
      pi=acos(-1.)
      pio2=pi/2.
      dtor=pi/180.
      rtod=180./pi
      iyd=15+30*(mois-1)

C  Read in array of latitudes defining CRISTA-O3 grid: +80 to -80 in 10 deg
C  Convert the values to colatitude

	OPEN(UNIT=23,file=ofile,form='formatted')

201	format(/,8x,17(1x,i3))
202	format(1x,i3,11x,17(1x,e10.4))
203	format(/)

	read(23,201) (x1O3(i),i=1,17)
	print*, 'Lat= ', (x1O3(i),i=1,17)

C convert to colatitude:
	do 22 j=1,17
        xO3(j)=pio2-x1O3(j)*dtor    
   22  continue

C  Read in altitude and CRISTA-O3 (ppmv)
C  Reverse the order of  the array (ground up - consistent setatmos)

	do 3 j=1,27    
	read(23,202) ialt(j),(diO3(i,j),i=1,17)
	print*,ialt(j),(alog(diO3(i,j)),i=1,17)
    3  continue

	print*, 'Alt= ', (ialt(i),i=1,27)
	CLOSE(UNIT=23)

      stop
      end

 
