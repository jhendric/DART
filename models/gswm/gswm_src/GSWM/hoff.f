      SUBROUTINE HOFF(IJ)

      DIMENSION H(3,5,45),T(45),C(91)

c  Modifications for 2-hemis; 2-deg grid capabilities
c       Array dimensions set to "upper limit value" (91) --M.Hagan (3/22/91)

c Patch to make arrays go from south to noth pole in accordance with LATVECS
C	--M. Hagan (12/8/92)

C Above patch removed, since LATVECT arrays now go from the north to south 
C	pole; see ~/specorig/hoff.f for patch details 	--M. Hagan (12/11/92)

      COMMON /MODEi/NZONAL,MOIS,NSS
      COMMON /MODEr/PERIOD,FREQ,FLUX
      COMMON/HOFFS/H11(91),H12(91),H13(91),H1M2(91),H1M1(91)
     1,H1M4(91),H22(91),H23(91),H24(91),H25(91),H26(91)
     + ,H33(91),H34(91),H35(91),H36(91)
      COMMON/HMODE/I11,I12,I13,I1M2,I1M1,I1M4,I22,I23,I24,I25,I26
     +,I33,I34,I35,I36

C latvect arrays are in colat from the north pole to the south pole
      COMMON/LATVECT/DTHETA,CLATT(91),XLAT(91),SNCLAT(91),CSCLAT(91),
     1    TNCLAT(91),CTNCLAT(91),SIN2I(91),GMLAT(91),DIP(91)

      DATA (H(1,1,J),J=1,45)/-.0007,-.0023,-.0047,-.0087,-.0153,-.0264,
     1 -.0445,-.0730,-.1158,-.1765,-.2568,-.3536,-.4561,-.5429,-.5824,
     2 -.5373,-.3747,-.0806, .3268, .7912,1.2262,1.5372,1.6502,1.5372,
     3 1.2262,.7912,.3268,-.0806,-.3747,-.5373,-.5824,-.5429,-.4561,
     4 -.3536,-.2568,-.1765,-.1158,-.0730,-.0445,-.0264,-.0153,-.0087,
     5 -.0047,-.0023,-.0007/

      DATA (H(1,2,J),J=1,45)/0.0,0.0,0.0,0.0,0.0,
     *  .0001,.0004,.0016,.0053,.0162,.0443
     1 ,.1073,.2240,.3900,.5329,.4879,.0703,-.6963,-1.3970,-1.3889,
     2 -.4082,.9478,1.5852,.9478,-.4082,-1.3889,-1.3970,-.6963,.0703,
     3 .4879,.5329,.3900,.2240,.1073,.0443,.0162,.0053,.0016,.0004,.0001
     4 ,0.0,0.0,0.0,0.0,0.0/

      DATA (H(1,3,J),J=1,45)/.0877,.2596,.4216,.5677,.6932,.7948,.8706,
     1 .9204,.9452,.9473,.9299,.8968,.8518,.7991,.7425,.6852,.6303,.5801
     2 ,.5368,.5016,.4758,.4601,.4548,.4601,.4758,.5016,.5368,.5801,
     3 .6303,.6852,.7425,.7991,.8518,.8968,.9299,.9473,.9452,.9204,.8706
     4 ,.7948,.6932,.5677,.4216,.2596,.0877/

      DATA (H(1,4,J),J=1,45)/.3739,1.0643,1.5950,1.8980,1.9517,1.7802,
     1 1.4420,1.0124,.56620,.1631,-.1588,-.3841,-.5157,-.5686,-.5634,
     2 -.5209,-.4593,-.3927,-.3305,-.2785,-.2401,-.2166,-.2088,-.2166,
     3 -.2401,-.2785,-.3305,-.3927,-.4593,-.5209,-.5634,-.5686,-.5157,
     4 -.3841,-.1588,.1631,.56620,1.0124,1.4420,1.7802,1.9517,1.8980,
     5 1.5950,1.0643,.3739/

      DATA (H(1,5,J),J=1,45)/0.0,0.0,.0001,.0002,.0007,.0017,.0044,.0107
     1  ,.0248,.0536,.1071,.1957,.3212,.4620,.5583,.5133,.2312,-.3072,
     2  -.9696,-1.4745,-1.5164,-.9661,0.0,.9661,1.5164,1.4745,.9696,
     3   .3072,-.2312,-.5133,-.5583,-.4620,-.3212,-.1957,-.1071,-.0536,
     4  -.0248,-.0107,-.0044,-.0017,-.0007,-.0002,-.0001,0.0,0.0/

      DATA (H(2,1,J),J=1,45)/0.0,0.0,.0004,.002,.0057,.0131,.0258,.0456,
     1 .0747,.1148,.1675,.2338,.3139,.4070,.5110,.6225,.7369,.8488,.9520
     2 ,1.043,1.1080,1.1507,1.1652,1.1507,1.1080,1.0403,.9520,.8488,
     3 .7369,.6225,.5110,.4070,.3139,.2338,.1675,.1148,.0747,.0456,.0258
     4 ,.0131,.0057,.002,.0004,0.0,0.0/

      DATA (H(2,2,J),J=1,45)/0.0,0.0,.0011,.0049,.0142,.0323,.0632,.1108
     1  ,.1788,.2694,.3826,.5152,.6601,.8061,.9383,1.0391,1.0907,1.0780,
     2  .9911,.8280,.5961,.3121,0.0,-.3121,-.5961,-.8280,-.9911,-1.0780,
     3  -1.0907,-1.0391,-.9383,-.8061,-.6601,-.5152,-.3826,-.2694,-.1788
     4  ,-.1108,-.0632,-.0323,-.0142,-.0049,-.0011,0.0,0.0/

      DATA (H(2,3,J),J=1,45)/0.0,.0001,.002,.009,.026,.059,.1146,.1984,
     1  .3138,.4595,.6271,.8001,.9535,1.0561,1.0760,.9873,.7792,.4622,
     2  .0710,-.3384,-.6990,-.9465,-1.0347,-.9465,-.6990,-.3384,.0710,
     3  .4622,.7792,.9873,1.0760,1.0561,.9535,.8001,.6271,.4595,.3138,
     4  .1984,.1146,.059,.026,.009,.002,.0001,0.0/

      DATA (H(2,4,J),J=1,45)/0.0,.001,.0032,.0144,.0412,.0930,.1786,
     1  .3039,.4683,.66,.853,1.0075,1.0747,1.0088,.7832,.4075,-.0638,
     2  -.5343,-.8883,-1.0245,-.893,-.5186,0.0,.5186,.893,1.0245,.8883,
     3  .5343,.0638,-.4075,-.7832,-1.0088,-1.0747,-1.0075,-.853,-.66,
     4  -.4683,-.3039,-.1786,-.0930,-.0412,-.0144,-.0032,-.001,0.0/

      DATA (H(2,5,J),J=1,45)/0.0,.0002,.0046,.0209,.0597,.1337,.2533,
     1  .422,.6291,.8437,1.0132,1.0705,.9536,.6345,.1473,-.3995,-.8431,
     2  -1.0209,-.8433,-.3501,.2841,.8113,1.0155,.8113,.2841,-.3501,
     3  -.8433,-1.0209,-.8431,-.3995,.1473,.6345,.9536,1.0705,1.0132,
     4  .8437,.6291,.422,.2533,.1337,.0597,.0209,.0046,.0002,0.0/

      DATA(H(3,1,J),J=1,45)/  .00018,  .00147,  .00500,  .01197,  .02365
     +, .04137,  .06647,  .10022,  .14373,  .19780,  .26278,
     +  .33840,  .42366,  .51676,  .61503,  .71502,  .81266,
     +  .90350,  .98301, 1.04696, 1.09177, 1.11486, 1.11778,
     + 1.11486, 1.09177, 1.04696,  .98301,  .90350,  .81266,
     +  .71502,  .61503,  .51676,  .42366,  .33840,  .26278,
     +  .19780,  .14373,  .10022,  .06647,  .04137,  .02365,
     +  .01197,  .00500,  .00147,  .00018/

      DATA(H(3,2,J),J=1,45)/ -.00055, -.00438, -.01478, -.03493, -.06786
     +,-.11617, -.18175, -.26535, -.36619, -.48148, -.60616,
     + -.73276, -.85166, -.95163,-1.02088,-1.04827,-1.02483,
     + -.94523, -.80888, -.62058, -.39049, -.13329, 0.00000,
     +  .13329,  .39049,  .62058,  .80888,  .94523, 1.02483,
     + 1.04827, 1.02088,  .95163,  .85166,  .73276,  .60616,
     +  .48148,  .36619,  .26535,  .18175,  .11617,  .06786,
     +  .03493,  .01478,  .00438,  .00055/

      DATA(H(3,3,J),J=1,45)/  .00121,  .00962,  .03207,  .07459,  .14180
     +, .23610,  .35681,  .49926,  .65416,  .80749,  .94116,
     + 1.03468, 1.06784, 1.02419,  .89472,  .68111,  .39759,
     +  .07075, -.26310, -.56287, -.78911, -.91079, -.92641,
     + -.91079, -.78911, -.56287, -.26310,  .07075,  .39759,
     +  .68111,  .89472, 1.02419, 1.06784, 1.03468,  .94116,
     +  .80749,  .65416,  .49926,  .35681,  .23610,  .14180,
     +  .07459,  .03207,  .00962,  .00121/

      DATA(H(3,4,J),J=1,45)/ -.00228, -.01795, -.05902, -.13459, -.24913
     +,-.40077, -.57978, -.76789, -.93891,-1.06142,-1.10358,
     +-1.03972, -.85777, -.56560, -.19421,  .20409,  .56349,
     +  .81743,  .91398,  .82961,  .57743,  .20673, 0.00000,
     + -.20673, -.57743, -.82961, -.91398, -.81743, -.56349,
     + -.20409,  .19421,  .56560,  .85777, 1.03972, 1.10358,
     + 1.06142,  .93891,  .76789,  .57978,  .40077,  .24913,
     +  .13459,  .05902,  .01795,  .00228/

101   FORMAT(1X,6HCOLAT=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
102   FORMAT(/)
100   FORMAT(3X, 4HI11=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
103   FORMAT(3X, 4HI12=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
200   FORMAT(3X, 4HI13=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
300   FORMAT(2X,5HI1M2=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
400   FORMAT(2X,5HI1M4=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
500   FORMAT(2X,5HI1M1=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
600   FORMAT(3X, 4HI22=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
700   FORMAT(3X, 4HI23=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
800   FORMAT(3X, 4HI24=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
900   FORMAT(3X, 4HI25=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
1000  FORMAT(3X, 4HI26=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
1100  FORMAT(3X, 4HI33=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
1200  FORMAT(3X, 4HI34=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
1300  FORMAT(3X, 4HI35=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)
1400  FORMAT(3X, 4HI36=,1X,10F7.2,/,8X,10F7.2,/,8X,10F7.2,
     +      /,8X,10F7.2)

C Preset arrays:
	do 99 i=1,91
	H11(i)=0.
	H12(i)=0.
	H13(i)=0.
	H1M1(i)=0.
	H1M2(i)=0.
	H1M4(i)=0.
	H22(i)=0.
	H23(i)=0.
	H24(i)=0.
	H25(i)=0.
	H26(i)=0.
	H33(i)=0.
	H34(i)=0.
	H35(i)=0.
	H36(i)=0.
   99 continue

	pi=acos(-1.)

      DO 1 I=1,45
1     T(I)=4.*FLOAT(I-1)+2.

      DO 2 I=1,IJ
2     C(I)=180.*CLATT(I)/pi
      PRINT 101, (C(I),I=1,IJ)
      PRINT 102


      IF(NZONAL-2) 110,11,113

  110 DO 22 I=1,IJ
   22 H1M1(I)=SNCLAT(I)*CSCLAT(I)
      CALL HOFFI(H,1,1,IJ,C,T,H11)
      CALL HOFFI(H,1,2,IJ,C,T,H13)
      CALL HOFFI(H,1,3,IJ,C,T,H1M2)
      CALL HOFFI(H,1,4,IJ,C,T,H1M4)
      CALL HOFFI(H,1,5,IJ,C,T,H12)
c     PRINT 100, (H11(I),I=1,IJ)
c     PRINT 102
c     PRINT 103, (H12(I),I=1,IJ)
c     PRINT 102
c     PRINT 200, (H13(I),I=1,IJ)
c     PRINT 102
c     PRINT 300, (H1M2(I),I=1,IJ)
c     PRINT 102
c     PRINT 400, (H1M4(I),I=1,IJ)
c     PRINT 102
c     PRINT 500, (H1M1(I),I=1,IJ)
c     PRINT 102
      GO TO 12
   11 CALL HOFFI(H,2,1,IJ,C,T,H22)
      CALL HOFFI(H,2,2,IJ,C,T,H23)
      CALL HOFFI(H,2,3,IJ,C,T,H24)
      CALL HOFFI(H,2,4,IJ,C,T,H25)
      CALL HOFFI(H,2,5,IJ,C,T,H26)
      PRINT 600, (H22(I),I=1,IJ)
      PRINT 102
c     PRINT 700, (H23(I),I=1,IJ)
c     PRINT 102
c     PRINT 800,  (H24(I),I=1,IJ)
c     PRINT 102
c     PRINT 900, (H25(I),I=1,IJ)
c     PRINT 102
c     PRINT 1000, (H26(I),I=1,IJ)
c     PRINT 102
      GO TO 12
  113 CALL HOFFI(H,3,3,IJ,C,T,H35)
      CALL HOFFI(H,3,4,IJ,C,T,H36)
c     PRINT 1100,(H33(I),I=1,IJ)
c     PRINT 102
c     PRINT 1200,(H34(I),I=1,IJ)
c     PRINT 102
c     PRINT 1300,(H35(I),I=1,IJ)
c     PRINT 102
c     PRINT 1400,(H36(I),I=1,IJ)
c     PRINT 102

   12 CONTINUE

      RETURN
      END
