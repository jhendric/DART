# DART software - Copyright 2004 - 2011 UCAR. This open source software is
# provided by UCAR, "as is", without charge, subject to all terms of use at
# http://www.image.ucar.edu/DAReS/DART/DART_download
#
# DART $Id$

1. ensemble_manager_mod.f90

	A. Line 151: Change write(seq_unit) ens(1, :)      to
			    write(seq_unit) ens

		Avoids compiler error for Josh (what compiler was this?)

	B. Line 165 (end of init_ensemble_manager)
		Add  ens_handle%null_variable = .false.
	        Avoids compiler warning on newer Intel for not making assignment
		  to intent out argument

	C. Allow direct public access to ens, ens_mean and ens_spread through public 
		interface. Also, add function to check if ensemble is in core, called
		is_ens_in_core.

	D. Test for file_name present in end_ensemble_manager and only write out if
		it is there. This corrects bad functionality in pre-h.
	E. Adjusted length of print statements for assim_model_state_ud and ic files
		to be a20 instead of a21 to allow Lahey compiler to work.


2. Integrate_model.f90:   removed unused end_ensemble_manager from use

3. new_obs_diag.f90
	General clean-up. Removed unused variables, fixed spelling.


4. perfect_model_obs.f90

	Modified to allow obs_sequences with existing observation values to drive
	a perfect_model run. Existing observations are replaced with synthetic ones.
	This major change has already been committed but needs to be tested on 
	multiple compilers.

	Additional change to clean-up code and add _r8 to new real constants.

5. assim_tools_mod.f90
	
	Removed look_for_bias (no longer used). Corrected errors in option 3 and option 4
	obs_increments. Added option 5 and option 6 obs_increment routines and changed
	error checking on namelist. Changed to allow a value to be kept for each region
	for the obs_space covariance inflation parameters and modified the format of the
	assim_restart file to carry a value for each region. THIS NEEDS TO BE TESTED
	on various platforms with various script options. 

	my_domain is no longer an argument to filter_assim_region. This also required
	removing this from the output and input files going between filter_assim
	and async_assim_region. This needs to be tested in parallel.

	Added ability to directly access ensemble storage from ensemble_manager in case
	when a single domain is being used and storage is in_core. WARNING: Need to verify
	that this works in parallel and that there is not a memory leak in filter_assim.

	Removed confidence slope which is no longer used. NOTE: This also impacts filter
	and filter.nml. It is VITAL to update the filter.nml namelist in use.

	Added cutoff to namelist as second entry, previously in filter. URGENT: namelists
	must be updated.

	Removed prior_spread_correction from namelist options.

	Changed computation of sample variance to form sum((ens-mean)**2) / ens_size-1
	to provide more stable computation and positive definite results in 
	obs_increment and obs_increment_enkf.

	Changed size of first_num_close from 100000 to min(model_size, 200000). This
	is large enough that wrf can use it but avoids having a big array for low orders.


6. filter.f90	

	Removed confidence_slope from namelist; no longer used.
	Removed cutoff from namelist, moved to assim_tools_mod namelist


	model_size arguement to obs_space_diagnostics deleted.

	Allow direct access to ensemble storage in cases where storage is in core for
	   obs and state space diagnostics and covariance inflation. This is purely a
	   speed issue to avoid copying storage and Alain says the time savings can
	   be significant.

	Modified the order of output for state and observation space diagnostic files.
	Mean comes first, then spread, then ensemble members. Required changes to 
	filter_generate_copy_meta_data, filter_state_space_diagnostics, and
	obs_space_diagnostics.

7. obs_sequence_mod.f90    Minor cosmetic changes.

8. obs_model_mod.f90	Minor cosmetic changes.

9. obs_def_mod.f90	Now using call to interactive time to create interactive sequences.

10. assim_model_mod.f90		Changed formatted write in awrite_state_restart
	to a loop over model_state to deal with Lahey formatted write problems.

11. Programs that create standard input for create_obs_sequence for bgrid model had
	been expecting the query about radar observations and have been patched so
	that they do not output an answer to this.
