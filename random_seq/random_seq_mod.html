<!--
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!                                                                       !!
!!                   GNU General Public License                          !!
!!                                                                       !!
!! This file is part of the Data Assimilation Research Testbed (DART).   !!
!!                                                                       !!
!! DART is free software; you can redistribute it and/or modify          !!
!! it and are expected to follow the terms of the GNU General Public     !!
!! License as published by the Free Software Foundation.                 !!
!!                                                                       !!
!! DART is distributed in the hope that it will be useful,               !!
!! but WITHOUT ANY WARRANTY; without even the implied warranty of        !!
!! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         !!
!! GNU General Public License for more details.                          !!
!!                                                                       !!
!! You should have received a copy of the GNU General Public License     !!
!! along with DART; if not, write to:                                    !!
!!          Free Software Foundation, Inc.                               !!
!!          59 Temple Place, Suite 330                                   !!
!!          Boston, MA  02111-1307  USA                                  !!
!! or see:                                                               !!
!!          http://www.gnu.org/licenses/gpl.txt                          !!
!!                                                                       !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-->

<HTML>
<TITLE>module random_seq_mod</TITLE>
<link rel=stylesheet type=text/css href=../doc/html/doc.css>
<BODY>

<!--kdr NAMELIST, PLANS, PRIVATE COMPONENTS have no destinationss -->
<DIV ALIGN=CENTER>
<A HREF="#Interface">INTERFACE</A> / 
<A HREF="#PublicEntities">PUBLIC COMPONENTS</A> / 
<A HREF="#Namelist">NAMELIST</A> / 
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#KnownBugs">BUGS</A> /
<A HREF="#FuturePlans">PLANS</A> /
<A HREF="#PrivateComponents">PRIVATE COMPONENTS</A>
</DIV>

<!--==================================================================-->

<H1>MODULE random_seq_mod</H1>
<A NAME="HEADER"></A>
<TABLE summary="">
   <TR><TD>Contact:       </TD><TD> Jeff Anderson                </TD></TR>
   <TR><TD>Reviewers:     </TD><TD> &nbsp;                       </TD></TR>
   <TR><TD>Revision:      </TD><TD> $Revision$             </TD></TR>
   <TR><TD>Release Name:  </TD><TD> $Name$                       </TD></TR>
   <TR><TD>Change Date:   </TD><TD> $Date$ </TD></TR>
   <TR><TD>Change history:</TD><TD> see CVS log                  </TD></TR>
</TABLE>

<!--==================================================================-->

<A NAME="OVERVIEW"></A>
<HR>
<H2>OVERVIEW</H2>

<P>
Provides access to any number of reproducible random sequences and allows
uniform, gaussian, and two-dimensional gaussian distributions to be
sampled.
</P>
<P>
</P>

<!--==================================================================-->

<A NAME="OTHER MODULES USED"></A>
<BR><HR><BR>
<H2>OTHER MODULES USED</H2>
<PRE>
types_mod
utilities_mod
random_nr_mod
</PRE>

<!--==================================================================-->
<!--Note to authors. The first row of the table is different.         -->

<A NAME="Interface"></A>
<BR><HR><BR>
<H2>PUBLIC INTERFACE</H2>

<TABLE>
<TR><TD><em class=call>use assim_model_mod, only : </em></TD>
                   <TD><A HREF="#random_seq_type">random_seq_type</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#init_random_seq">init_random_seq</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#random_gaussian">random_gaussian</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#several_random_gaussians">several_random_gaussians</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#random_uniform">random_uniform</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#twod_gaussians">twod_gaussians</A></TD></TR>
</TABLE>

<H3 class=indent1>NOTES</H3>

<!--==================================================================-->
<!-- Declare all public entities ...                                  -->
<!-- duplicate public routines template as many times as necessary    -->
<!-- make sure you replace all yyyroutine?? strings                   -->
<!--==================================================================-->

<A NAME="PublicEntities"></A>
<BR><HR><BR>
<H2>PUBLIC COMPONENTS</H2>
</P>


<!--=================== DESCRIPTION OF A LOCAL TYPE ==================-->

<A NAME="random_seq_type"></A>
<BR><HR><BR>
<div class=type><pre>
<em class=call>type random_seq_type</em>
   private
end type random_seq_type
</pre></div>

<H3 class=indent1>Description</H3>

<P>
This type is used to uniquely identify a sequence. In this implementation,
it is passed through directly from the random_nr_mod and details can be
seen in that module.
</P>

<!--=================== DESCRIPTION OF A LOCAL TYPE ==================-->

<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="init_random_seq"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call init_random_seq(r) </em>
 <pre>
 type(random_seq_type), intent(inout) :: <em class=code>r</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Initializes a random sequence for use. This must be called before
any random numbers can be generated from this sequence. Any number
of independent, reproducible random sequences can be generated by
having multiple instances of a random_seq_type.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>r&nbsp; &nbsp; </em></TD>
     <TD>A random sequence.</TD></TR>
 </TABLE>
<BR>

<!--============= DESCRIPTION OF A FUNCTION ========================-->
 <A NAME="random_gaussian"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> var = random_gaussian(r, mean, standard_deviation) </em>
 <pre>
 real(r8)                             :: <em class=code>random_gaussian</em>
 type(random_seq_type), intent(inout) :: <em class=code>r</em>
 real(r8), intent(in)                 :: <em class=code>mean</em>
 real(r8), intent(in)                 :: <em class=code>standard_deviation</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Returns a random draw from a Gaussian distribution with mean and
standard deviation.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>random_gaussian&nbsp; &nbsp; </em></TD>
     <TD>A random draw from a gaussian distribution.</TD></TR>
 <TR><TD valign=top><em class=code>r&nbsp; &nbsp; </em></TD>
     <TD>The reproducible random sequence.</TD></TR>
 <TR><TD valign=top><em class=code>mean&nbsp; &nbsp; </em></TD>
     <TD>Mean of the gaussian.</TD></TR>
 <TR><TD valign=top><em class=code>standard_deviation&nbsp; &nbsp; </em></TD>
     <TD>Standard deviation of the gaussian.</TD></TR>
 </TABLE>
 <BR>

<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="several_random_gaussians"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call several_random_gaussians(r, mean, standard_deviation, n, rnum) </em>
 <pre>
 type(random_seq_type), intent(inout) :: <em class=code>r</em>
 real(r8), intent(in)                 :: <em class=code>mean</em>
 real(r8), intent(in)                 :: <em class=code>standard_deviation</em>
 integer, intent(in)                  :: <em class=code>n</em>
 real(r8), intent(out), dimension(:)  :: <em class=code>rnum</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Returns n random samples from a gaussian with mean and standard
deviation. Make sure that there is enough room in rnum for all the
returned values.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>r&nbsp; &nbsp; </em></TD>
     <TD>A reproducible random sequence.</TD></TR>
 <TR><TD valign=top><em class=code>mean&nbsp; &nbsp; </em></TD>
     <TD>Mean of the Gaussian to be sampled.</TD></TR>
 <TR><TD valign=top><em class=code>standard_deviation&nbsp; &nbsp; </em></TD>
     <TD>Standard deviation of the Gaussian.</TD></TR>
 <TR><TD valign=top><em class=code>n&nbsp; &nbsp; </em></TD>
     <TD>Number of samples to return</TD></TR>
 <TR><TD valign=top><em class=code>rnum&nbsp; &nbsp; </em></TD>
     <TD>The random samples of the Gaussian.</TD></TR>
 </TABLE>
 <BR>

<!--============= DESCRIPTION OF A FUNCTION ========================-->
 <A NAME="random_uniform"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> var = random_uniform(r) </em>
 <pre>
 real(r8)                             :: <em class=code>random_uniform</em>
 type(random_seq_type), intent(inout) :: <em class=code>r</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Returns a random draw from a uniform distribution on interval [0,1].
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>random_uniform&nbsp; &nbsp; </em></TD>
     <TD>A random draw from a Uniform[0,1] distribution.</TD></TR>
 <TR><TD valign=top><em class=code>r&nbsp; &nbsp; </em></TD>
     <TD>A random sequence.</TD></TR>
 </TABLE>
 <BR>

<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="twod_gaussians"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call twod_gaussians(r,mean,cov,rnum) </em>
 <pre>
 type(random_seq_type), intent(inout)  :: <em class=code>r</em>
 real(r8), dimension(2), intent(in)    :: <em class=code>mean</em>
 real(r8), dimension(2, 2), intent(in) :: <em class=code>cov</em>
 real(r8), dimension(2), intent(out)   :: <em class=code>rnum</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Returns a random draw from a 2D gaussian with mean and covariance.
The algorithm used is from Knuth, exercise 13, section 3.4.1.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>r&nbsp; &nbsp; </em></TD>
     <TD>A random sequence.</TD></TR>
 <TR><TD valign=top><em class=code>mean&nbsp; &nbsp; </em></TD>
     <TD>Mean of 2D gaussian distribution.</TD></TR>
 <TR><TD valign=top><em class=code>cov&nbsp; &nbsp; </em></TD>
     <TD>Covariance of 2D gaussian.</TD></TR>
 <TR><TD valign=top><em class=code>rnum&nbsp; &nbsp; </em></TD>
     <TD>Returned random draw from gaussian.</TD></TR>
 </TABLE>
 <BR>


<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<BR><HR><BR>
<H2>FILES</H2>
<UL><LI>NONE
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<BR><HR><BR>
<H2>REFERENCES</H2>

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!-- Putting a <BR> after the synopsis creates a nice effect.         -->
<!--==================================================================-->

<A NAME="Errors"></A>
<HR>
<H2>ERROR CODES and CONDITIONS</H2>

<!--==================================================================-->
<!-- Describe the bugs.                                               -->
<!--==================================================================-->

<A NAME="KnownBugs"></A>
<BR><HR><BR>
<H2>KNOWN BUGS</H2>
<P>
</P>

<!--==================================================================-->
<!-- Descibe Future Plans.                                            -->
<!--==================================================================-->


<!--==================================================================-->
<!-- Have not fleshed out this part yet ... ha ha ha                  -->
<!--==================================================================-->

<!--==================================================================-->

<HR>
</BODY>
</HTML>
