<!--
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!                                                                       !!
!!                   GNU General Public License                          !!
!!                                                                       !!
!! This file is part of the Data Assimilation Research Testbed (DART).   !!
!!                                                                       !!
!! DART is free software; you can redistribute it and/or modify          !!
!! it and are expected to follow the terms of the GNU General Public     !!
!! License as published by the Free Software Foundation.                 !!
!!                                                                       !!
!! DART is distributed in the hope that it will be useful,               !!
!! but WITHOUT ANY WARRANTY; without even the implied warranty of        !!
!! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         !!
!! GNU General Public License for more details.                          !!
!!                                                                       !!
!! You should have received a copy of the GNU General Public License     !!
!! along with DART; if not, write to:                                    !!
!!          Free Software Foundation, Inc.                               !!
!!          59 Temple Place, Suite 330                                   !!
!!          Boston, MA  02111-1307  USA                                  !!
!! or see:                                                               !!
!!          http://www.gnu.org/licenses/gpl.txt                          !!
!!                                                                       !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-->

<HTML>
<TITLE>module assim_tools_smoother_mod</TITLE>
<link rel=stylesheet type=text/css href=../doc/html/doc.css>
<BODY>

<!--kdr INTERFACE has no destination -->
<DIV ALIGN=CENTER>
<A HREF="#Interface">INTERFACE</A> / 
<A HREF="#PublicEntities">PUBLIC COMPONENTS</A> / 
<A HREF="#Namelist">NAMELIST</A> / 
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#KnownBugs">BUGS</A> /
<A HREF="#FuturePlans">PLANS</A> /
<A HREF="#PrivateComponents">PRIVATE COMPONENTS</A>
</DIV>

<!--==================================================================-->

<H1>MODULE assim_tools_smoother_mod</H1>
<A NAME="HEADER"></A>
<TABLE summary="">
   <TR><TD>Contact:       </TD><TD> Jeff Anderson                </TD></TR>
   <TR><TD>Reviewers:     </TD><TD> &nbsp;                       </TD></TR>
   <TR><TD>Revision:      </TD><TD> $Revision$             </TD></TR>
   <TR><TD>Release Name:  </TD><TD> $Name$                       </TD></TR>
   <TR><TD>Change Date:   </TD><TD> $Date$ </TD></TR>
   <TR><TD>Change history:</TD><TD> see CVS log                  </TD></TR>
</TABLE>
<BR>

<!--==================================================================-->

<A NAME="OVERVIEW"></A>
<HR>
<H2>OVERVIEW</H2>
This module provides subroutines that implement the sequential scalar
filter algorithms. These include the standard sequential filter as 
described in Anderson (2003) along with systematic correction algorithms
for both mean and spread. In addition, algorithms to do a variety of 
flavors of filters including the EAKF, ENKF, particle filter, and kernel
filters are included. Additionally, the code has been modified for
applications of the smoother.
<BR>

<!--==================================================================-->

<A NAME="OTHER MODULES USED"></A>
<BR><HR><BR>
<H2>OTHER MODULES USED</H2>
<PRE>
types_mod
utilities_mod
sort_mod
random_seq_mod
obs_sequence_mod
obs_def_mod
cov_cutoff_mod
obs_model_mod
reg_factor_mod
location_mod (model dependent choice)
ensemble_manager_mod

</PRE>

<!--==================================================================-->
<!--Note to authors. The first row of the table is different.         -->

<A NAME="Interface"></A>
<BR><HR><BR>
<H2>PUBLIC INTERFACE</H2>

<TABLE>
<TR><TD><em class=call>use assim_tools_smoother_mod, only : </em></TD>
                   <TD><A HREF="#yyyroutine1">assim_tools_init   </A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine2">obs_increment (Now Private)      </A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine3">update_from_obs_inc (Now Private)</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine5">filter_assim       </A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#yyyroutine6">async_assim_region </A></TD></TR>
</TABLE>

<BR>
<P>
Optional namelist interface
<A HREF="#Namelist"> <em class=code>&#38;assim_tools_smoother_nml</em> </A>
may be read from file <em class=file>input.nml</em>.
</P>


<!--==================================================================-->
<!-- Declare all public entities ...                                  -->
<!-- duplicate public routines template as many times as necessary    -->
<!-- make sure you replace all yyyroutine?? strings                   -->
<!--==================================================================-->

<A NAME="PublicEntities"></A>
<BR><HR><BR>
<H2>PUBLIC COMPONENTS</H2>
<BR>


<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine1"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call>call assim_tools_init(  )</em>
<pre>
</pre></div>

<H3 class=indent1>Description</H3>

<P>
   Initialization routine for assim_tools. This must be called before other 
   public interfaces can be used.   
</P>


<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine2"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call> call obs_increment( ens_in, ens_size, obs, obs_var, obs_inc)</em>
<pre>
real(r8), intent(in), dimension(ens_size)  :: <em class=code>ens_in </em>
integer, intent(in)                        :: <em class=code>ens_size </em>
real(r8), intent(in)                       :: <em class=code>obs </em>
real(r8), intent(in)                       :: <em class=code>obs_var </em>
real(r8), intent(out), dimension(ens_size) :: <em class=code>obs_inc </em>
</pre></div>

<H3 class=indent1>Description</H3>

<P>
   Does a scalar update of a prior ensemble in observation space and computes
   the increments for each prior ensemble member. Four different ensemble filter
   algorithms are selectable through a namelist arguement. The EAKF variant also
   includes a capability to do an empirical systematic error correction. 
   Obs_increment also implements the adaptive systematic error correction
   algorithm using observation space covariance inflation. A number of 
   options for this algorithm are selected through namelist parameters.
</P>

<TABLE width=100% border=0 summary="" cellpadding=3>

<TR><TD valign=top><em class=code>ens_in &nbsp; &nbsp; </em></TD>
    <TD>The prior ensemble expected values for this observation.</TD></TR>

<TR><TD valign=top><em class=code>ens_size</em></TD>
    <TD>Size of the prior ensemble.</TD></TR>

<TR><TD valign=top><em class=code>obs</em></TD>
    <TD>The observed value (from the instrument).</TD></TR>

<TR><TD valign=top><em class=code>obs_var</em></TD>
    <TD>The observational error variance (from the observing system).</TD></TR>

<TR><TD valign=top><em class=code>obs_inc</em></TD>
    <TD>The increments computed for the prior ensemble.</TD></TR>

</TABLE>


<!--===================== DESCRIPTION OF SUBROUTINE =====================-->

<A NAME="yyyroutine3"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call> call update_from_obs_inc(obs, obs_inc, state, ens_size,
   state_inc, reg_coef,
               <em class=optionalcode>[,correl_out]</em> )</em>
<pre>
real(r8), intent(in), dimension(ens_size)  :: <em class=code>obs </em>
real(r8), intent(in), dimension(ens_size)  :: <em class=code>obs_inc </em>
real(r8), intent(in), dimension(ens_size)  :: <em class=code>state </em>
integer, intent(in)                        :: <em class=code>ens_size </em>
real(r8), intent(out), dimension(ens_size) :: <em class=code>state_inc </em>
real(r8), intent(out)                      :: <em class=code>reg_coef </em>
real(r8), OPTIONAL, intent(out)            :: <em class=optionalcode>correl_out </em>
</pre></div>

<H3 class=indent1>Description</H3>

<P>
   Given the prior joint distribution of an observation and a state variable
   along with computed increments for the observation ensemble members, uses
   a linear regression to compute increments for the state variable ensemble.
   An optional algorithm to do prior corrections of spread reduction is also
   available for use with the EAKF variant of the filter. The increments and the
   regression coefficient are returned and optionally the correlation between
   the state and observation priors.
</P>

<TABLE width=100% border=0 summary="" cellpadding=3>

<TR><TD valign=top><em class=code>obs &nbsp; &nbsp; </em></TD>
    <TD>The prior ensemble expected values for this observation.</TD></TR>

<TR><TD valign=top><em class=code>obs_inc &nbsp; &nbsp; </em></TD>
    <TD>The observation increments for the ensemble computed by
        obs_increment.</TD></TR>

<TR><TD valign=top><em class=code>state &nbsp; &nbsp; </em></TD>
    <TD>The prior ensemble values for a state variable.</TD></TR>

<TR><TD valign=top><em class=code>ens_size</em></TD>
    <TD>Size of the ensemble.</TD></TR>

<TR><TD valign=top><em class=code>state_inc</em></TD>
    <TD>The increments computed for the state variable ensemble.</TD></TR>

<TR><TD valign=top><em class=code>reg_coef</em></TD>
    <TD> The regression coefficient between the observation and state variable
         ensembles.</TD></TR>

<TR><TD valign=top><em class=optionalcode>correl_out</em></TD>
    <TD>Optional sample correlation between state and prior.</TD></TR>

</TABLE>

<!--==================================================================-->
 <!--============= DESCRIPTION OF A SUBROUTINE =======================-->
<A NAME="yyyroutine5"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call filter_assim(ens_handle, ens_obs, compute_obs_in, ens_size,
	 model_size, num_obs_in_set, num_groups, seq, keys, cutoff, 
	 save_reg_series, reg_series_unit, obs_seq_in_name, lag) </em>
 <pre>
 type(ensemble_type), intent(in)                           :: <em class=code>ens_handle</em>
 real(r8), dimension(ens_size, num_obs_in_set), intent(in) :: <em class=code>ens_obs</em>
 logical, dimension(num_obs_in_set), intent(in)            :: <em class=code>compute_obs_in</em>
 integer, intent(in)                                       :: <em class=code>ens_size</em>
 integer, intent(in)                                       :: <em class=code>model_size</em>
 integer, intent(in)                                       :: <em class=code>num_obs_in_set</em>
 integer, intent(in)                                       :: <em class=code>num_groups</em>
 type(obs_sequence_type), intent(inout)                    :: <em class=code>seq </em>
 integer, dimension(num_obs_in_set), intent(in)            :: <em class=code>keys</em>
 real(r8), intent(in)                                      :: <em class=code>cutoff</em>
 logical, intent(in)                                       :: <em class=code>save_reg_series</em>
 integer, intent(in)                                       :: <em class=code>reg_series_unit</em>
 character(len=*), intent(in)                              :: <em class=code>obs_seq_in_name</em>
 integer, intent(in)                                       :: <em class=code>lag</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Entry subroutine to do an assimilation for a given observation set. 
Calls are made to internal subroutine 
filter_assim_region to do actual assimilation for each domain
as requested by the num_domains namelist parameter. This public
subroutine can either call filter_assim_region directly or create appropriate
files for each domain and use the shell to execute programs to do the regions
(controlled by do_parallel option in namelist). The current parallel assimilation
algorithm does not recompute any observations but simply updates the prior
distribution each time another observation is assimilated. For single
domain use, the compute_obs_in logical array indicates if there are state 
variables that cannot (or should not) be recomputed during the sequential
assimilation. Support for the reg_series output is very limited with this release
and is confined to low-order models. Note that modifications have been made 
to update an array of ensemble handles for a given lag to implement the smoother.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>ens_handle&nbsp; &nbsp;      </em></TD>
     <TD>Identifies ensemble (see ensemble_manager_mod)              </TD></TR>
 <TR><TD valign=top><em class=code>ens_obs&nbsp; &nbsp;         </em></TD>
     <TD>Ensemble prior values for observations                      </TD></TR>
 <TR><TD valign=top><em class=code>compute_obs_in&nbsp; &nbsp;  </em></TD>
     <TD>True if corresponding observation can be recomputed here    </TD></TR>
 <TR><TD valign=top><em class=code>ens_size&nbsp; &nbsp;        </em></TD>
     <TD>Ensemble size                                               </TD></TR>
 <TR><TD valign=top><em class=code>model_size&nbsp; &nbsp;      </em></TD>
     <TD>Model state vector length                                   </TD></TR>
 <TR><TD valign=top><em class=code>num_obs_in_set&nbsp; &nbsp;  </em></TD>
     <TD>Number of observations to be assimilated                    </TD></TR>
 <TR><TD valign=top><em class=code>num_groups&nbsp; &nbsp;      </em></TD>
     <TD>Number of groups for filter                                 </TD></TR>
 <TR><TD valign=top><em class=code>seq&nbsp; &nbsp;             </em></TD>
     <TD>Observation sequence                                        </TD></TR>
 <TR><TD valign=top><em class=code>keys&nbsp; &nbsp;            </em></TD>
     <TD>Indices of the current observations in seq                  </TD></TR>
 <TR><TD valign=top><em class=code>cutoff&nbsp; &nbsp;           </em></TD>
     <TD>Localization factor (see update_from_obs_inc)                </TD></TR>
 <TR><TD valign=top><em class=code>save_reg_series&nbsp; &nbsp;  </em></TD>
     <TD>True to save regression stats (low-order only)               </TD></TR>
 <TR><TD valign=top><em class=code>reg_series_unit&nbsp; &nbsp;  </em></TD>
     <TD>Open to regression stats file if needed                      </TD></TR>
 <TR><TD valign=top><em class=code>obs_seq_in_name&nbsp; &nbsp;  </em></TD>
     <TD>Obs sequence is written here if shell driven multiple domains</TD></TR>
 </TABLE>

 <!--================================================================-->
<!--============= DESCRIPTION OF A SUBROUTINE =======================-->
<A NAME="yyyroutine6"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call async_assim_region(in_file_name,out_file_name, lag) </em>
 <pre>
 character(len=*), intent(in) :: <em class=code>in_file_name</em>
 character(len=*), intent(in) :: <em class=code>out_file_name</em>
 integer, intent(in) :: <em class=code>lag</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
This is a subroutine designed to allow calls to filter_assim_region to
be handled by separate processes through the shell. Instead of having 
a direct call from filter_assim, filter_assim writes out all the arguments
for filter_assim_region for a given region to a file. The shell then
starts a program, assim_region, which calls async_assim_region with 
the appropriate file names. The arguments are obtained by the file
by async_assim_region and then a call is made to subroutine 
filter_assim_region. At completion, the output arguments are written
to out_file_name. Note slight modification has been made to implement the smoother.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>in_file_name&nbsp; &nbsp; </em></TD>
     <TD>File where input required for filter_assim_region is found</TD></TR>
 <TR><TD valign=top><em class=code>out_file_name&nbsp; &nbsp; </em></TD>
     <TD>File where output from filter_assim_region is to be put</TD></TR>
 </TABLE>
 <BR>

<!--=================== DESCRIPTION OF A NAMELIST  ===================-->

<A NAME="Namelist"></A>
<BR><HR><BR>
<H2>NAMELIST</H2>
<P>We adhere to the F90 standard of starting a namelist with an ampersand 
'&#38;' and terminating with a slash '/'.
<div class=namelist><pre>
<em class=call>namelist / assim_tools_smoother_nml / </em> &#38;
filter_kind, cutoff, sort_obs_inc, &#38;
cov_inflate, cov_inflate_sd, sd_lower_bound, deterministic_cov_inflate, &#38;
start_from_assim_restart, assim_restart_in_file_name, assim_restart_out_file_name, &#38;
do_parallel, num_domains, parallel_command, &#38;
spread_restoration, cov_inflate_upper_bound, internal_outlier_threshold
</pre></div>

<H3 class=indent1>Discussion</H3>

<P>This namelist is read in a file called <em class=file>input.nml</em>
</P>

<TABLE border=0 cellpadding=3 width=100%>
<TR><TH align=left>Contents    </TH>
    <TH align=left>Type        </TH>
    <TH align=left>Description </TH></TR>
<TR><!--contents--><TD valign=top>filter_kind  </TD>
    <!--  type  --><TD valign=top>integer      </TD>
    <!--descript--><TD>Selects the variant of filter to be used. 1=EAKF, 2=ENKF, 3=Kernel filter, 
                       4=particle filter.  Default: 1.</TD></TR>
<TR><!--contents--><TD valign=top>cutoff                       </TD>
    <!--  type  --><TD valign=top>real(r8)                     </TD>
    <!--descript--><TD>Cutoff controls a distance dependent weight that modulates
                       the impact of an observation on a state variable. The units depend
                       both on the location module being used and on the covariance cutoff
                       module options selected. Default is 0.2.</TD></TR>
<TR><!--contents--><TD valign=top>sort_obs_inc </TD>
    <!--  type  --><TD valign=top>logical      </TD>
    <!--descript--><TD> If true, the final increments from obs_increment are
                        sorted so that the mean increment value is as small
                        as possible. This minimizes regression errors when
                        non-deterministic filter or error correction algorithms
                        are applied. Default: false.</TD></TR>
<TR><!--contents--><TD valign=top>cov_inflate                       </TD>
    <!--  type  --><TD valign=top>real(r8)                     </TD>
    <!--descript--><TD>Value of the deterministic, state space covariance inflation. 
    Default: -1.0 </TD></TR>			

<TR><!--contents--><TD valign=top>cov_inflate_sd                       </TD>
    <!--  type  --><TD valign=top>real(r8)                     </TD>
    <!--descript--><TD>Value of adaptive covariance inflate standard deviation.
    Default: 0.05. </TD></TR>

<TR><!--contents--><TD valign=top>sd_lower_bound                       </TD>
    <!--  type  --><TD valign=top>real(r8)                     </TD>
    <!--descript--><TD>Lower bound of adaptive inflation standard deviation. Default: 0.05. </TD></TR>			

<TR><!--contents--><TD valign=top>deterministic_cov_inflate                      </TD>
    <!--  type  --><TD valign=top>logical                     </TD>
    <!--descript--><TD>If true, use determinstic spatial covariance inflation.
    Default: .true. </TD></TR>

<TR><!--contents--><TD valign=top>start_from_assim_restart                      </TD>
    <!--  type  --><TD valign=top>logical                     </TD>
    <!--descript--><TD>If true, start from assim_restart. Default: .false. </TD></TR>
    
<TR><!--contents--><TD valign=top>assim_restart_in_file_name                      </TD>
    <!--  type  --><TD valign=top>character(len=129)                     </TD>
    <!--descript--><TD>File name for assim restart. Default: 'assim_tools_ics'</TD></TR>
<TR><!--contents--><TD valign=top>assim_restart_out_file_name                      </TD>
    <!--  type  --><TD valign=top>character(len=129)                     </TD>
    <!--descript--><TD>File name for assim restart output file. Default: 'assim_tools_restart'</TD></TR>    

			
 <TR><!--contents--><TD valign=top>do_parallel</TD>
     <!--  type  --><TD valign=top>integer</TD>
     <!--descript--><TD>Execution control: 0 = single executable; 2 = parallel_command; 
	     3 = use filter_server Default: 0</TD></TR>
 <TR><!--contents--><TD valign=top>num_domains</TD>
     <!--  type  --><TD valign=top>integer</TD>
 <!--descript--><TD>Use this many subdomains; assimilate each independently Default: 1</TD></TR>
 <TR><!--contents--><TD valign=top>parallel_command</TD>
     <!--  type  --><TD valign=top>character(len=129)</TD>
 <!--descript--><TD>Command to be executed for option 2.  Default: ./assim_filter.csh</TD></TR>
 <TR><!--contents--><TD valign=top>spread_restoration</TD>
     <!--  type  --><TD valign=top>logical</TD>
 <!--descript--><TD> True turns on algorithm to restore amount of spread that would be
             expected to be lost if underlying obs/state variable correlation were really
             0.  Default: false </TD></TR>
	     
	     
	     
 <TR><!--contents--><TD valign=top>internal_outlier_threshold</TD>
     <!--  type  --><TD valign=top>real</TD>
 <!--descript--><TD> Like the global outlier threshold in the filter, except it
    is applied during the sequential update phase. If the difference between the 
    prior ensemble mean and the observed value is more than this many standard
    deviations of the expected value, the observation is not used. It will still 
    appear in the diagnostic output since this is generated in the filter before the
    sequential phase begins.  Default: -1.0</TD></TR>

 

</TABLE>

<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<BR><HR><BR>
<H2>FILES</H2>
<UL><LI>input.nml
<LI>assim_tools_ics:  Default name for file containing initial values of 
                      cov_inflate and cov_inflate_sd.
<LI>filter_assim_region__in####:  Contains ensemble state for region.
<LI>filter_assim_region_out####:  Contains updated state for region.
<LI>assim_region_control:  Used to provide number of regions to shell execution.
<LI>in_file_name, out_file_name: arguments to async_assim_region.
<LI>filter_assim_obs_seq: Stores obs sequence on disk for async assimilation.
<LI>assim_tools_smoother_mod.nml in input.nml
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<BR><HR><BR>
<H2>REFERENCES</H2>
Anderson, Jeffrey L. "A Local Least Squares Framework for Ensemble Filtering"
April 2003, MWR 131, pp 634-642

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!-- Putting a <BR> after the synopsis creates a nice effect.         -->
<!--==================================================================-->

<A NAME="Errors"></A>
<HR>
<H2>ERROR CODES and CONDITIONS</H2>
<div class="errors">
<TABLE border=1 cellspacing=1 cellpadding=10 width=100%>
<TR><TH>Routine</TH><TH>Message</TH><TH>Comment</TH></TR>

<TR><!-- routine --><TD VALIGN=top>assim_tools_init</TD>
    <!-- message --><TD VALIGN=top>do parallel option # not supported</TD>
    <!-- comment --><TD VALIGN=top>Only the following are currently supported: <BR>
                    0; assimilation not parallel <BR>
                    2; assimilation parallel, use parallel_command from namelist <BR>
                    3; assimilation parallel, separate script runs assimilation </TD>
</TR>
<TR><!-- routine --><TD VALIGN=top>obs_increment</TD>
    <!-- message --><TD VALIGN=top>Illegal value of filter_kind in assim_tools namelist [1-4 OK]</TD>
    <!-- comment --><TD VALIGN=top>Only 1-4 currently supported.</TD>
</TR>
<TR><!-- routine --><TD VALIGN=top>obs_increment_eakf <BR>
                                   obs_increment_ran_kf <BR>
                                   obs_increment_det_kf </TD> 
    <!-- message --><TD VALIGN=top>Both obs_var and prior_var are zero. This is inconsistent</TD>
    <!-- comment --><TD VALIGN=top>Product of two delta functions doesn't work.</TD>
</TR>

<TR><!-- routine --><TD VALIGN=top>filter_assim</TD>
    <!-- message --><TD VALIGN=top>Use less than 10000 domains.</TD>
    <!-- comment --><TD VALIGN=top> Need to modify code for more than 10000 domains.</TD>
</TR>
<TR><!-- routine --><TD VALIGN=top>filter_assim</TD>
    <!-- message --><TD VALIGN=top>Did not find observation copy with metadata "observation"</TD>
    <!-- comment --><TD VALIGN=top> In obs_sequence file, need to find copy that is observations.</TD>
</TR>
<TR><!-- routine --><TD VALIGN=top>filter_assim</TD>
    <!-- message --><TD VALIGN=top>Having more domains than state variables does not make sense</TD>
    <!-- comment --><TD VALIGN=top> It doesn't.</TD>
</TR>
</TR>
</TABLE>
</div>

<!--==================================================================-->
<!-- Describe the bugs.                                               -->
<!--==================================================================-->

<A NAME="KnownBugs"></A>
<BR><HR><BR>
<H2>KNOWN BUGS</H2>
<P>
The current version of the systematic error correction algorithm does
not work in a logical fashion with the parallel region assimilation 
feature. 
</P>

<!--==================================================================-->
<!-- Descibe Future Plans.                                            -->
<!--==================================================================-->

<A NAME="FuturePlans"></A>
<BR><HR><BR>
<H2>FUTURE PLANS</H2>
<P>
</P>

<!--==================================================================-->
<!-- Have not fleshed out this part yet ... ha ha ha                  -->
<!--==================================================================-->

<A NAME="PrivateComponents"></A>
<BR><HR><BR>
<H2>PRIVATE COMPONENTS</H2>

<div class=routine>
<pre>
type location_type
   private
   real(r8) :: x
end type location_type</pre>
</div>

<H3 class=indent1>Discussion</H3>

<!--==================================================================-->

<HR>
</BODY>
</HTML>
