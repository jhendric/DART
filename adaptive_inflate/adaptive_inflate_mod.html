<!--
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!                                                                       !!
!!                   GNU General Public License                          !!
!!                                                                       !!
!! This file is part of the Data Assimilation Research Testbed (DART).   !!
!!                                                                       !!
!! DART is free software; you can redistribute it and/or modify          !!
!! it and are expected to follow the terms of the GNU General Public     !!
!! License as published by the Free Software Foundation.                 !!
!!                                                                       !!
!! DART is distributed in the hope that it will be useful,               !!
!! but WITHOUT ANY WARRANTY; without even the implied warranty of        !!
!! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         !!
!! GNU General Public License for more details.                          !!
!!                                                                       !!
!! You should have received a copy of the GNU General Public License     !!
!! along with DART; if not, write to:                                    !!
!!          Free Software Foundation, Inc.                               !!
!!          59 Temple Place, Suite 330                                   !!
!!          Boston, MA  02111-1307  USA                                  !!
!! or see:                                                               !!
!!          http://www.gnu.org/licenses/gpl.txt                          !!
!!                                                                       !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-->

<HTML>
<TITLE>module adaptive_inflate_mod</TITLE>
<link rel=stylesheet type=text/css href=../doc/html/doc.css>
<BODY>

<!--kdr INTERFACE has no destination -->
<DIV ALIGN=CENTER>
<A HREF="#Interface">INTERFACE</A> / 
<A HREF="#PublicEntities">PUBLIC COMPONENTS</A> / 
<A HREF="#Namelist">NAMELIST</A> / 
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#KnownBugs">BUGS</A> /
<A HREF="#FuturePlans">PLANS</A> /
<A HREF="#PrivateComponents">PRIVATE COMPONENTS</A>
</DIV>

<!--==================================================================-->

<H1>MODULE adaptive_inflate_mod</H1>
<A NAME="HEADER"></A>
<TABLE summary="">
   <TR><TD>Contact:       </TD><TD> Jeff Anderson                </TD></TR>
   <TR><TD>Reviewers:     </TD><TD> &nbsp;                       </TD></TR>
   <TR><TD>Revision:      </TD><TD> $Revision$             </TD></TR>
   <TR><TD>Release Name:  </TD><TD> $Name$                       </TD></TR>
   <TR><TD>Change Date:   </TD><TD> $Date$ </TD></TR>
   <TR><TD>Change history:</TD><TD> see CVS log                  </TD></TR>
</TABLE>
<BR>

<!--==================================================================-->

<A NAME="OVERVIEW"></A>
<HR>
<H2>OVERVIEW</H2>
<P>
This module implements a variety of hierarchical Bayesian adaptive 
inflation algorithms for use with ensemble filters. It can provide 
constant valued inflation in state or obsevation space, consistent with
previous DART releases. It can provide spatially-constant, time-varying 
spatial adaptive inflation. It can provide spatially-varying, time-varying
spatial adaptive inflation and it can provide temporally-varying 
observation space inflation. Diagnostic output and restart files are 
available. Several papers on the NCAR/IMAGe/DAReS web page document the
algorithms in detail. The <em class=file>DART/tutorial/section12</em> 
chapter has more information. 
<BR>
<BR>
The namelist documentation describes how to use different inflation
options.
</P>

<!--==================================================================-->

<A NAME="OTHER MODULES USED"></A>
<BR><HR><BR>
<H2>OTHER MODULES USED</H2>
<PRE>
types_mod
utilities_mod
random_seq_mod
time_manager_mod
</PRE>

<!--==================================================================-->
<!--Note to authors. The first row of the table is different.         -->

<A NAME="Interface"></A>
<BR><HR><BR>
<H2>PUBLIC INTERFACE</H2>

<TABLE>
<TR><TD><em class=call>use adaptive_inflate_mod, only : </em></TD>
                   <TD><A HREF="#update_inflation">update_inflation   </A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#adaptive_inflate_ss_init">adaptive_inflate_ss_init   </A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#adaptive_inflate_end">adaptive_inflate_end</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#adaptive_inflate_obs_init">adaptive_inflate_obs_init  </A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#inflate_ens">inflate_ens</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#output_inflate_diagnostics">output_inflate_diagnostics</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#inflate_control">do_obs_inflate</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#inflate_control">do_single_ss_inflate</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#inflate_control">do_varying_ss_inflate</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#ss_inflate_storage">ss_inflate</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#ss_inflate_storage">ss_inflate_sd</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#obs_inflate_storage">obs_inflate</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#obs_inflate_storage">obs_inflate_sd</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#ss_params">ss_sd_lower_bound</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#ss_params">ss_inf_upper_bound</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#obs_params">obs_sd_lower_bound</A></TD></TR>
<TR><TD>&nbsp;</TD><TD><A HREF="#obs_params">obs_inf_upper_bound</A></TD></TR>
</TABLE>

<BR>
<P>
Optional namelist interface
<A HREF="#Namelist"> <em class=code>&#38;adaptive_inflate_nml</em> </A>
may be read from file <em class=file>input.nml</em>.
</P>


<!--==================================================================-->
<!-- Declare all public entities ...                                  -->
<!-- duplicate public routines template as many times as necessary    -->
<!-- make sure you replace all yyyroutine?? strings                   -->
<!--==================================================================-->

<A NAME="PublicEntities"></A>
<BR><HR><BR>
<H2>PUBLIC COMPONENTS</H2>
<BR>

</TABLE>

 <!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="update_inflation"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call update_inflation(inflate,inflate_sd,prior_mean,
      prior_var,obs,obs_var,gamma,sd_lower_bound,
      inf_upper_bound) </em>
 <pre>
 real(r8), intent(inout) :: <em class=code>inflate</em>
 real(r8), intent(inout) :: <em class=code>inflate_sd</em>
 real(r8), intent(in)    :: <em class=code>prior_mean</em>
 real(r8), intent(in)    :: <em class=code>prior_var</em>
 real(r8), intent(in)    :: <em class=code>obs</em>
 real(r8), intent(in)    :: <em class=code>obs_var</em>
 real(r8), intent(in)    :: <em class=code>gamma</em>
 real(r8), intent(in)    :: <em class=code>sd_lower_bound</em>
 real(r8), intent(in)    :: <em class=code>inf_upper_bound</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
 Updates the mean and standard deviation of an inflation distribution
 given the prior values, the prior observation ensemble mean and
variance, and the observation and its error variance. The factor gamma
is the expected impact (0 to 1) of the state variable corresponding to
the infaltion on the observation and is the product of the ensemble
correlation plus and additional localization factors or group regression
factors.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>inflate&nbsp; &nbsp; </em></TD>
     <TD>Prior mean value of the inflation distribution.</TD></TR>
 <TR><TD valign=top><em class=code>inflate_sd&nbsp; &nbsp; </em></TD>
     <TD>Prior standard deviation of the inflation distribution.</TD></TR>
 <TR><TD valign=top><em class=code>prior_mean&nbsp; &nbsp; </em></TD>
     <TD>Mean of the prior observation ensemble.</TD></TR>
 <TR><TD valign=top><em class=code>prior_var&nbsp; &nbsp; </em></TD>
     <TD>Variance of the prior observation ensemble.</TD></TR>
 <TR><TD valign=top><em class=code>obs&nbsp; &nbsp; </em></TD>
     <TD>The observed value.</TD></TR>
 <TR><TD valign=top><em class=code>obs_var&nbsp; &nbsp; </em></TD>
     <TD>Observational error variance.</TD></TR>
 <TR><TD valign=top><em class=code>gamma&nbsp; &nbsp; </em></TD>
     <TD>Expected impact factor, product of correlation, localization, regression factor.</TD></TR>
 <TR><TD valign=top><em class=code>sd_lower_bound&nbsp; &nbsp; </em></TD>
     <TD>Lower bound on updated inflation standard deviation.</TD></TR>
 <TR><TD valign=top><em class=code>inf_upper_bound&nbsp; &nbsp; </em></TD>
     <TD>Upper bound on updated inflation mean.</TD></TR>
 </TABLE>
 <P>
 <!--================================================================-->

 <!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="adaptive_inflate_ss_init"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call adaptive_inflate_ss_init(model_size) </em>
 <pre>
 integer, intent(in) :: <em class=code>model_size</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
 Initializes the module if state space inflation is being used. Allocates
required storage for the inflation mean and standard deviation, reads 
restart files, and gets initial values from the namelist as required.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>model_size&nbsp; &nbsp; </em></TD>
     <TD>Size of the model.</TD></TR>
 </TABLE>
 <P>
 <!--================================================================-->

 <!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="adaptive_inflate_end"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call adaptive_inflate_end() </em>
 <pre>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Writes required restart files and deallocates storage used for inflation
mean and standard deviation. 
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 </TABLE>
 <P>
 <!--================================================================-->


 <!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="adaptive_inflate_obs_init"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call adaptive_inflate_obs_init(num_domains,dont_read_restart) </em>
 <pre>
 integer, intent(in) :: <em class=code>num_domains</em>
 logical, intent(in) :: <em class=code>dont_read_restart</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
 Reads restarts and intializes inflation values for observation space inflation. 
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>num_domains&nbsp; &nbsp; </em></TD>
     <TD>Number of domains if parallel assimilation is being done.</TD></TR>
 <TR><TD valign=top><em class=code>dont_read_restart&nbsp; &nbsp; </em></TD>
     <TD>Don't read in a restart no matter what namelist says.</TD></TR>
 </TABLE>
 <P>
 <!--================================================================-->

 <!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="inflate_ens"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call inflate_ens(ens,mean,inflate,var_in) </em>
 <pre>
 real(r8), dimension(:), intent(out) :: <em class=code>ens</em>
 real(r8), intent(in)                :: <em class=code>mean</em>
 real(r8), intent(in)                :: <em class=code>inflate</em>
 real(r8), optional, intent(in)      :: <em class=code>var_in</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
Given an ensemble, its mean and the covarance inflation factor,
inflates the ensemble. 
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>ens&nbsp; &nbsp; </em></TD>
     <TD>Values for the ensemble to be inflated</TD></TR>
 <TR><TD valign=top><em class=code>mean&nbsp; &nbsp; </em></TD>
     <TD>The mean of the ensemble.</TD></TR>
 <TR><TD valign=top><em class=code>inflate&nbsp; &nbsp; </em></TD>
     <TD>The covariance inflation factor.</TD></TR>
 <TR><TD valign=top><em class=code>var_in&nbsp; &nbsp; </em></TD>
     <TD>The variance of the ensemble.</TD></TR>
 </TABLE>
 <P>
 <!--================================================================-->


 <!--============= DESCRIPTION OF A SUBROUTINE =======================-->
 <A NAME="output_inflate_diagnostics"></A>
 <P></P><HR><P></P>
 <div class=routine>
 <em class=call> call output_inflate_diagnostics(time) </em>
 <pre>
 type(time_type), intent(in) :: <em class=code>time</em>
 </pre></div>
 <H3 class=indent1>Description</H3>
 <P>
 Outputs diagnostic record of inflation for the observation space of
spatially constant state space inflation. Spatially varying state space
diagnostics are in the Posterior and Prior Diagnostic netcdf files and
are written with calls from filter.f90.
 </P>
 <TABLE width=100% border=0 summary="" celpadding=3>
 <TR><TD valign=top><em class=code>time&nbsp; &nbsp; </em></TD>
     <TD>Time of this diagnostic info.</TD></TR>
 </TABLE>
 <P>
 <!--================================================================-->


<!--===================== DESCRIPTION OF PUBLIC VARIABLE =====================-->

<A NAME="inflate_control"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call>logical :: do_obs_inflate, do_fixed_ss_inflate, do_varying_ss_inflate </em>
<pre>
</pre></div>

<H2 class=indent1>Description</H2>

<P>
This allows public access to these namelist variables which determine which
inflation options are in use. See namelist documentation.
</P>


<BR>

<!--================================================================-->



<!--===================== DESCRIPTION OF PUBLIC VARIABLE =====================-->

<A NAME="ss_inflate_storage"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call>real(r8), allocatable :: ss_inflate(:), ss_inflate_sd(:) </em>
<pre>
</pre></div>

<H2 class=indent1>Description</H2>

<P>
These two arrays are managed by adaptive_inflate_mod and contain the mean
and standard deviation of the inflation distributions. If fixed spatial
inflation is in use, the size of each is 1. If varying spatial inflation is
in use, the size of each is model_size. This direct access is for efficiency
and is not a very safe programming practice.
</P>


<BR>

<!--================================================================-->

<!--===================== DESCRIPTION OF PUBLIC VARIABLE =====================-->

<A NAME="obs_inflate_storage"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call>real(r8), allocatable :: obs_inflate(:), obs_inflate_sd(:) </em>
<pre>
</pre></div>

<H2 class=indent1>Description</H2>

<P>
These two arrays are managed by adaptive_inflate_mod and contain the mean
and standard deviation of the inflation distributions for observation
space inflation. The size of each is the number of parallel domains/regions
in use. This direct access is for efficiency and is not a very safe 
programming practice.
</P>


<BR>

<!--================================================================-->



<!--===================== DESCRIPTION OF PUBLIC VARIABLE =====================-->

<A NAME="ss_params"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call>real(r8) :: ss_sd_lower_bound, ss_inf_upper_bound </em>
<pre>
</pre></div>

<H2 class=indent1>Description</H2>

<P>
This allows public access to these namelist variables. The first sets a
hard lower bound on the standard deviation for the state space 
inflation distribution and the second puts a hard upper bound on the mean.
See the namelist documentation for more information.
</P>


<BR>

<!--================================================================-->


<!--===================== DESCRIPTION OF PUBLIC VARIABLE =====================-->

<A NAME="obs_params"></A>
<P></P><HR><P></P>
<div class=routine>
<em class=call>real(r8) :: obs_sd_lower_bound, obs_inf_upper_bound </em>
<pre>
</pre></div>

<H2 class=indent1>Description</H2>

<P>
This allows public access to these namelist variables. The first sets a
hard lower bound on the standard deviation for the observation space
inflation distribution and the second puts a hard upper bound on the mean.
See the namelist documentation for more information.
</P>


<BR>

<!--================================================================-->


 <!--============== DESCRIPTION OF A NAMELIST ========================-->
 <A NAME="Namelist"></A>
 <BR><HR><BR>
 <P>We adhere to the F90 standard of starting a namelist with an ampersand
 '&' and terminating with a slash '/'.
 <div class=namelist><pre>
 <em class=call>namelist / adaptive_inflate_nml / </em>
 do_obs_inflate,do_varying_ss_inflate,do_single_ss_inflate,
start_from_inflate_restart,output_restart,deterministic_inflate,
inflate_in_file_name,inflate_out_file_name,obs_inf_initial,
obs_inf_sd_initial,obs_sd_lower_bound,obs_inf_upper_bound,
ss_inf_initial,ss_inf_sd_initial,ss_sd_lower_bound,ss_inf_up
 </pre></div>
 <H3 class=indent1>Discussion</H3>
 <P>

The namelist controls the operation of the various inflation options.
The three entries, do_obs_inflate, do_varying_ss_inflate, and do_single_ss_inflate
select what type of inflation to do. At most one of these can be true; all
false indicates no inflation. 
<BR><BR>
To do traditional, fixed state space inflation, select do_single_ss_inflate,
set ss_inf_initial to the desired inflation value and set the 
ss_inf_sd_initial and ss_sd_lower_bound to negative values.

<BR><BR>
To do temporally-varying but spatially constant inflation, select do_single_ss_inflate
and set ss_inf_initial and ss_inf_sd_initial to the desired initial values. To
avoid potential inflation filter divergence, the ss_sd_lower_bound can be set.
If ss_inf_sd_initial and ss_sd_lower_bound are set to the same value, the standard
deviation will remain fixed at the intial value. To avoid large inflation values,
ss_inf_upper_bound can be set to limit the mean inflation values.

<BR><BR>
To do spatially-varying temorarlly-varying inflation, select do_varying_ss_inflate
and set ss_inf_initial and ss_inf_sd_initial to the desired initial values. To
avoid potential inflation filter divergence, the ss_sd_lower_bound can be set.  
If ss_inf_sd_initial and ss_sd_lower_bound are set to the same value, the standard
deviation will remain fixed at the intial value. To avoid large inflation values,
ss_inf_upper_bound can be set to limit the mean inflation values.


<BR><BR>
To do temporally-fixed observation space inflation, select do_obs_inflate,
set obs_inf_initial to the desired inflation value and set obs_inf_sd_initial
and obs_sd_lower_bound to negative values.

<BR><BR>
To do temporally-varying observation space inflation (this was the adaptive
algorithm available in previous DART releases), select do_obs_inflate,
and set obs_inf_initial and obs_inf_sd_initial to the desired initial values. To
avoid potential inflation filter divergence, the obs_sd_lower_bound can be set.
If obs_inf_sd_initial and obs_sd_lower_bound are set to the same value, the standard
deviation will remain fixed at the intial value. To avoid large inflation values,
obs_inf_upper_bound can be set to limit the mean inflation values.

<BR><BR>
 </em>
 </P>
 <P>This namelist is read in a file called <em class=file>input.nml</em>
 </P>
 <TABLE border=0 cellpadding=3 width=100%>
 <TR><TH align=left>Contents    </TH>
     <TH align=left>Type        </TH>
     <TH align=left>Description </TH></TR>
 <TR><!--contents--><TD valign=top>do_obs_inflate</TD>
     <!--  type  --><TD>logical</TD>
 <!--descript--><TD>True to do obs space inflation. Default: .false.</TD></TR>
 <TR><!--contents--><TD valign=top>do_varying_ss_inflate</TD>
     <!--  type  --><TD>logical</TD>
 <!--descript--><TD>True to do spatially-varying temporally-varying inflation. Default: .false.</TD></TR>
 <TR><!--contents--><TD valign=top>do_single_ss_inflate</TD>
     <!--  type  --><TD>logical</TD>
 <!--descript--><TD>True to do spatially constant temporally-varying state space inflation. Default: .false.</TD></TR>
 <TR><!--contents--><TD valign=top>start_from_inflate_restart</TD>
     <!--  type  --><TD>logical</TD>
 <!--descript--><TD>True if initial inflation distributions are to be read from restart file. Default: .false.</TD></TR>
 <TR><!--contents--><TD valign=top>output_restart</TD>
     <!--  type  --><TD>logical</TD>
 <!--descript--><TD>True if final inflation distribution values are to be written to restart file. Default: .true.</TD></TR>
 <TR><!--contents--><TD valign=top>deterministic_inflate</TD>
     <!--  type  --><TD>logical</TD>
 <!--descript--><TD>True if inflation is to be done by linear inflation. False implies stocahstic inflation. Default: .true.</TD></TR>
 <TR><!--contents--><TD valign=top>inflate_in_file_name</TD>
     <!--  type  --><TD>character(len=129)</TD>
 <!--descript--><TD>Inflation restart file name. Default: inflate_ics</TD></TR>
 <TR><!--contents--><TD valign=top>inflate_out_file_name</TD>
     <!--  type  --><TD>character(len=129)</TD>
 <!--descript--><TD>Inflation output restart file name. Default: inflate_restart</TD></TR>
 <TR><!--contents--><TD valign=top>obs_inf_initial</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Initial value of obs space inflation mean if not starting from restart. Default: 1.0</TD></TR>
 <TR><!--contents--><TD valign=top>obs_inf_sd_initial</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Initial value of obs space inflation standard deviation. 0 or negative gives time constant. Default: 0.0</TD></TR>
 <TR><!--contents--><TD valign=top>obs_sd_lower_bound</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Hard lower bound on the standard deviation for obs space inflation. Default: 0.0</TD></TR>
 <TR><!--contents--><TD valign=top>obs_inf_upper_bound</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Hard upper bound on the mean for obs space inflation. Default: 10000000</TD></TR>
 <TR><!--contents--><TD valign=top>ss_inf_initial</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Initial value of state space inflation mean if not starting from restart. Default: 1.0</TD></TR>
 <TR><!--contents--><TD valign=top>ss_inf_sd_initial</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Initial value of state space inflation standard deviation. 0 or negative gives time constant. Default: 0.0</TD></TR>
 <TR><!--contents--><TD valign=top>ss_sd_lower_bound</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Hard lower bound on the standard deviation for state space inflation. Default: 0.0</TD></TR>
 <TR><!--contents--><TD valign=top>ss_inf_upper_bound</TD>
     <!--  type  --><TD>real</TD>
 <!--descript--><TD>Hard upper bound on the mean for state space inflation. Default: 10000000</TD></TR>
 <TR><!--contents--><TD valign=top>diagnostic_file_name</TD>
     <!--  type  --><TD>character(len=129)</TD>
 <!--descript--><TD>File name of output diagnostic file used for obs space and fixed state space inflation. Default: inflate_diag</TD></TR>
 </TABLE>
 <P>
 <!--================================================================-->

<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<BR><HR><BR>
<H2>FILES</H2>
<UL><LI>input.nml
<LI>inflate_ics:  Default name for file containing initial values of 
                      inflation mean and standard deviation.
<LI>inflate_restart:  Default name for file that outputs final values
		of inflation mean and standard deviation.
<LI>inflate_diag:  Contains diagnostic history of inflation values for 
	obs space and spatially-fixed state space inflation. Diagnostics
	for spatially-varying state space inflation are extra fields on
	the Posterior and Prior diagnostic netcdf files created in filter.f90.
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<BR><HR><BR>
<H2>REFERENCES</H2>
<LI>
Anderson, Jeffrey L., 2006: An adaptive covariance inflation error 
correction algorithm for ensemble filters.

<LI> 
Anderson, Jeffrey L., 2006: Spatially-varying adaptive covariance 
inflation in an ensemble filter.

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!-- Putting a <BR> after the synopsis creates a nice effect.         -->
<!--==================================================================-->

<A NAME="Errors"></A>
<HR>
<H2>ERROR CODES and CONDITIONS</H2>
<div class="errors">
<TABLE border=1 cellspacing=1 cellpadding=10 width=100%>
<TR><TH>Routine</TH><TH>Message</TH><TH>Comment</TH></TR>

<TR><!-- routine --><TD VALIGN=top>adaptive_inflate_init</TD>
    <!-- message --><TD VALIGN=top>Can only use one type of inflation at a time.</TD>
    <!-- comment --><TD VALIGN=top>No more than one of the do_inflation options can be true. <BR>
</TR>
<TR><!-- routine --><TD VALIGN=top>adaptive_inflate_ss_init</TD>
    <!-- message --><TD VALIGN=top>Size of state space restart file is incorrect.</TD>
    <!-- comment --><TD VALIGN=top>Restart file must have single entry for fixed spatial inflation
and model_size entries for spatially-varying inflation.</TD>
</TR>
<TR><!-- routine --><TD VALIGN=top>adaptive_inflate_obs_init </TD> 
    <!-- message --><TD VALIGN=top>Number of domains in restart not same as number of domains.</TD>
    <!-- comment --><TD VALIGN=top>Restart must be same size as number of domains in use.</TD>
</TR>

</TR>
</TABLE>
</div>

<!--==================================================================-->
<!-- Describe the bugs.                                               -->
<!--==================================================================-->

<A NAME="KnownBugs"></A>
<BR><HR><BR>
<H2>KNOWN BUGS</H2>
<P>

</P>

<!--==================================================================-->
<!-- Descibe Future Plans.                                            -->
<!--==================================================================-->

<A NAME="FuturePlans"></A>
<BR><HR><BR>
<H2>FUTURE PLANS</H2>
<P>
</P>

<!--==================================================================-->
<!-- Have not fleshed out this part yet ... ha ha ha                  -->
<!--==================================================================-->

<A NAME="PrivateComponents"></A>
<BR><HR><BR>
<H2>PRIVATE COMPONENTS</H2>

<div class=routine>
<pre>
</div>

<H3 class=indent1>Discussion</H3>

<!--==================================================================-->

<HR>
</BODY>
</HTML>
