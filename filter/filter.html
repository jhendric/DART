<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
          "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<TITLE>program filter</TITLE>
<link rel="stylesheet" type="text/css" href="../doc/html/doc.css">
</HEAD>
<BODY>
<A NAME="TOP"></A>

<center>
<A HREF="#Modules">MODULES</A> /
<A HREF="#Namelist">NAMELIST</A> /
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#FuturePlans">PLANS</A> /
<A HREF="#Legalese">TERMS OF USE</A>
</center>

<H1>PROGRAM <em class=program>filter</em></H1>
<!-- version tag follows, do not edit --><P>$Id$</P>

<P>
   Main program for driving ensemble filter assimilations. 
   <br>
   <br>
   The basic execution loop is:
</P>

<UL><LI>Read in initial conditions, observations, set up and initialize</LI>
    <LI>Until out of observations:
    <UL><LI>Run model to advance data</LI>
        <LI>Assimilate all observations in the current time window</LI>
        <LI>Repeat</LI>
    </UL></LI>
    <LI>Write out diagnostic files, restart files, 
        final observation sequence file</LI>
</UL>

<P>
   See the <A href="http://www.image.ucar.edu/DAReS/DART">DART web site</A> 
   for detailed discussion of the capabilities of the
   assimilation system, a diagram of the entire execution cycle, the options
   and features.
</P>

<P>
   NOTE: The different types of assimilation algorithms 
   (EAKF, ENKF, Kernel filter, Particle filter, etc.) are determined
   by the <em class=code>&amp;assim_tools_nml:filter_kind</em> entry,
   described in <a href="../assim_tools/assim_tools_mod.html">assim_tools_mod.html</a>.
   Despite having 'filter' in the name, they are assimilation algorithms
   and so are implemented in <em class=file>assim_tools_mod.f90</em>.
</P>

<P>
   <em class=program>filter</em> provides a number of options that are 
   driven from its namelist. The number of assimilation steps to be done 
   are controlled by the input observation sequence and by the 
   time-stepping capabilities of the model being used in the assimilation.
</P>

<P>
   The filter adds a quality control field with metadata 'DART quality control'
   to the obs_seq.final file. At present, this field can have the following
   values:
</P>

<TABLE border=0 cellpadding=3 width=100%>
   <TR><TD>0:</TD><TD> Observation is okay </TD></TR>
   <TR><TD>1:</TD><TD> Observation was evaluated only but not
      used in the assimilation </TD></TR>
   <TR><TD>2:</TD><TD> The observation was used but one or more of
      the posterior forward observation operators failed </TD></TR>
   <TR><TD>3:</TD><TD> The observation
      was evaluated only but not used AND one or more of the posterior 
      forward observation operators failed </TD></TR>
   <TR><TD>4:</TD><TD> One or more prior forward observation
      operators failed so the observation was not used </TD></TR>
   <TR><TD>5:</TD><TD> The observation was
      not used because it was not selected in the namelist to be assimilated
      or evaluated </TD></TR>
   <TR><TD>6:</TD><TD> The prior quality control value was too high so the
      observation was not used.  </TD></TR>
   <TR><TD>7:</TD><TD> Outlier test failed (see below)</TR>
</TABLE>

<P>
   The filter also can perform an outlier threshold test on observations. If
   the prior ensemble mean differs from the observed value by more than a
   specified number of standard deviations, it is not used and the DART
   quality control field is set to 7.
</P>

<P>
Optional namelist interface
<A HREF="#Namelist"> <em class=code>&amp;filter_nml</em> </A>
may be read from file <em class=file>input.nml</em>.
</P>

<!--==================================================================-->

<A NAME="Modules"></A>
<HR>
<H2>MODULES USED</H2>
<PRE>
types_mod
obs_sequence_mod
obs_def_mod
time_manager_mod
utilities_mod
assim_model_mod
assim_tools_mod
obs_model_mod
ensemble_manager_mod
adaptive_inflate_mod
mpi_utilities_mod
smoother_mod
</PRE>

<!--==================================================================-->
<!--=================== DESCRIPTION OF A NAMELIST ====================-->
<!--==================================================================-->

<A NAME="Namelist"></A>
<HR>
<H2>NAMELIST</H2>
<P>We adhere to the F90 standard of starting a namelist with an ampersand
'&amp;' and terminating with a slash '/' for all our namelist input.
Consider yourself forewarned that character strings that contain a '/' must be
enclosed in quotes to prevent them from prematurely terminating the namelist.
The namelist declaration (i.e. what follows) has a different syntax, naturally.
</P>
<div class=namelist>
<pre>
<em class=call>namelist / filter_nml / </em>
  async,
  adv_ens_command,
  tasks_per_model_advance,
  ens_size,
  start_from_restart,
  output_restart,
  obs_sequence_in_name,
  obs_sequence_out_name,
  restart_in_file_name,
  restart_out_file_name,
  init_time_days,
  init_time_seconds,
  first_obs_days,
  first_obs_seconds,
  last_obs_days,
  last_obs_seconds,
  obs_window_days,
  obs_window_seconds,
  num_output_state_members,
  num_output_obs_members,
  output_interval,
  num_groups,
  input_qc_threshold,
  outlier_threshold,
  output_forward_op_errors,
  output_timestamps,
  output_inflation,
  trace_execution,
  silence,
    
  inf_flavor,
  inf_initial_from_restart,
  inf_sd_initial_from_restart,
  inf_output_restart,
  inf_deterministic,
  inf_in_file_name,
  inf_out_file_name,
  inf_diag_file_name,
  inf_initial,
  inf_sd_initial,
  inf_damping,
  inf_lower_bound,
  inf_upper_bound,
  inf_sd_lower_bound
</pre>
</div>

<div class=indent1>
<!-- Description -->

<P>
Controls various aspects of filter. The inflation control variables are all
dimensioned 2, the first value being for the prior inflation and the second
being for the posterior inflation.
<br>
<br>
This namelist is read in a file called <em class=file>input.nml</em>
</P>

<TABLE border=0 cellpadding=3 width=100%>
<TR><TH align=left>Contents    </TH>
    <TH align=left>Type        </TH>
    <TH align=left>Description </TH></TR>

<TR><!--contents--><TD valign=top>async</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>Controls method for advancing model: 
                       0 is subroutine call, 
                       2 is shell command, 
                       4 is mpi-job script. 
                       Default: 0</TD></TR>

<TR><!--contents--><TD valign=top>adv_ens_command</TD>
    <!--  type  --><TD valign=top>character(len=129)</TD>
    <!--descript--><TD>Command sent to shell if async is 2. 
                       Default: ./advance_model.csh</TD></TR>

<TR><!--contents--><TD valign=top>tasks_per_model_advance</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>Reserved for future use.
                       Default: 1</TD></TR>

<TR><!--contents--><TD valign=top>ens_size</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>Size of ensemble.
                       Default: 20</TD></TR>

<TR><!--contents--><TD valign=top>start_from_restart</TD>
    <!--  type  --><TD valign=top>logical</TD>
    <!--descript--><TD>True means start from a restart file, false means 
                       perturb a single state vector in restart file. 
                       Default: .false.</TD></TR>

<TR><!--contents--><TD valign=top>output_restart</TD>
    <!--  type  --><TD valign=top>logical</TD>
    <!--descript--><TD>True means output a restart file. 
                       Default: .false.</TD></TR>

<TR><!--contents--><TD valign=top>obs_sequence_in_name</TD>
    <!--  type  --><TD valign=top>character(len=129)</TD>
    <!--descript--><TD>File name from which to read an observation sequence. 
                       Default: obs_seq.out</TD></TR>

<TR><!--contents--><TD valign=top>obs_sequence_out_name</TD>
    <!--  type  --><TD valign=top>character(len=129)</TD>
    <!--descript--><TD>File name to which to write output observation sequence. 
                       Default: obs_seq.final</TD></TR>

<TR><!--contents--><TD valign=top>restart_in_file_name</TD>
    <!--  type  --><TD valign=top>character(len=129)</TD>
    <!--descript--><TD>File containing state restart vectors. 
                       Default: filter_ics</TD></TR>

<TR><!--contents--><TD valign=top>restart_out_file_name</TD>
    <!--  type  --><TD valign=top>character(len=129)</TD>
    <!--descript--><TD>File to which to write restart state vectors. 
                       Default: filter_restart</TD></TR>

<TR><!--contents--><TD valign=top>init_time_days</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative, don't use. If non-negative, override the initial 
                       days read from state data restart file. 
                       Default: 0</TD></TR>

<TR><!--contents--><TD valign=top>init_time_seconds</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative don't use. If non-negative, override the initial
                       seconds read from state data restart file. 
                       Default: 0</TD></TR>

<TR><!--contents--><TD valign=top>first_obs_days</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative, don't use. If non-negative, ignore all observations
                       before this time.
                       Default: -1</TD></TR>

<TR><!--contents--><TD valign=top>first_obs_seconds</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative, don't use. If non-negative, ignore all observations
                       before this time.
                       Default: -1</TD></TR>

<TR><!--contents--><TD valign=top>last_obs_days</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative, don't use. If non-negative, ignore all observations
                       after this time.
                       Default: -1</TD></TR>

<TR><!--contents--><TD valign=top>last_obs_seconds</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative, don't use. If non-negative, ignore all observations
                       after this time.
                       Default: -1</TD></TR>

<TR><!--contents--><TD valign=top>obs_window_days</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative, don't use. If non-negative, reserved for future use.
                       Default: -1</TD></TR>

<TR><!--contents--><TD valign=top>obs_window_seconds</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>If negative, don't use. If non-negative, reserved for future use.
                       Default: -1</TD></TR>

<TR><!--contents--><TD valign=top>num_output_state_members</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>Number of ensemble members to be included in the state 
                       diagnostic output. Default: 0</TD></TR>

<TR><!--contents--><TD valign=top>num_output_obs_members</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>Number of ensemble members to be included in the 
                       observation sequence file. Default: 0</TD></TR>

<TR><!--contents--><TD valign=top>output_interval</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>Output state and observation diagnostics every 'N'th 
                       assimilation time, N is output_interval. Default: 1</TD></TR>

<TR><!--contents--><TD valign=top>num_groups</TD>
    <!--  type  --><TD valign=top>integer</TD>
    <!--descript--><TD>Number of groups for hierarchical filter. Default: 1</TD></TR>

<TR><!--contents--><TD valign=top>outlier_threshold</TD>
    <!--  type  --><TD valign=top>real(r8)</TD>
    <!--descript--><TD>Reject observation if prior mean is more than this many 
                       sd's from observation. Negative means no check. 
                       Default: -1.0_r8</TD></TR>

<TR><!--contents--><TD valign=top>input_qc_threshold</TD>
    <!--  type  --><TD valign=top>real(r8)</TD>
    <!--descript--><TD>Reject observation if incoming QC value exceeds
                       'input_qc_threshold' value. Incoming observations usually have a
                       QC value set by the data provider, e.g. NCEP. 
                       Default: 3.0_r8</TD></TR>

<TR><!--contents--><TD valign=top>output_forward_op_errors</TD>
    <!--  type  --><TD valign=top>logical</TD>
    <!--descript--><TD>True means output errors from forward observation operators.
                       This is the 'istatus' error return code from the model
                       interpolate routine.  An ascii text file 'prior_forward_op_errors'
                       and/or 'post_forward_op_errors' will be created in the
                       current directory.  Each line will contain an observation key
                       number, the ensemble member number, and the istatus return code.
                       Default: .false.</TD></TR>

<TR><!--contents--><TD valign=top>output_timestamps</TD>
    <!--  type  --><TD valign=top>logical</TD>
    <!--descript--><TD>True means output timestamps before and after the model advance
                       and the observation assimilation phases.
                       Default: .false.</TD></TR>

<TR><!--contents--><TD valign=top>output_inflation</TD>
    <!--  type  --><TD valign=top>logical</TD>
    <!--descript--><TD>True means output inflation values in the prior and posterior
                       diagnostic files.  False omits them.
                       Default: .true.</TD></TR>

<TR><!--contents--><TD valign=top>trace_execution</TD>
    <!--  type  --><TD valign=top>logical</TD>
    <!--descript--><TD>True means output very detailed messages about what routines
                       are being called in the main filter loop.  Useful if a job
                       hangs or otherwise doesn't execute as expected.
                       Default: .false.</TD></TR>

<TR><!--contents--><TD valign=top>silence</TD>
    <!--  type  --><TD valign=top>logical</TD>
    <!--descript--><TD>True means output almost no runtime messages.  Not recommended
                       for general use, but can speed test programs if the execution
                       time becomes dominated by the volume of output. 
                       Default: .false.</TD></TR>

<TR><TD colspan=3>All subsequent variables are arrays of length 2.<br>
                  The first element is for the prior, the second element is 
                  for the posterior</TD></TR>

<TR><!--contents--><TD valign=top>inf_flavor</TD>
    <!--  type  --><TD valign=top>integer array (len=2)</TD>
    <!--descript--><TD>Inflation flavor for [prior, posterior]<br>
                       0&nbsp;=&nbsp;none,
                       1&nbsp;=&nbsp;obs_space, 
                       2&nbsp;=&nbsp;spatially-varying&nbsp;state&nbsp;space,
                       3&nbsp;=&nbsp;spatially-fixed&nbsp;state&nbsp;space. 
                       (See sd_initial below for how to set the time
                       evolution options.)
                       Default: (/0, 0/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_initial_from_restart</TD>
    <!--  type  --><TD valign=top>logical array (len=2)</TD>
    <!--descript--><TD>If true, get initial mean values for inflation from restart file.
                       (Replaces inf_start_from_restart, which applied to
                       both mean and standard deviation.  
                       They are now individually controllable)
                       If false, use the corresponding namelist value inf_initial.
                       Default: (/.false., .false /)</TD></TR>

<TR><!--contents--><TD valign=top>inf_sd_initial_from_restart</TD>
    <!--  type  --><TD valign=top>logical array (len=2)</TD>
    <!--descript--><TD>If true, get initial standard deviation values for 
                       inflation from restart file.
                       (Replaces inf_start_from_restart, which applied to
                       both mean and standard deviation.  
                       They are now individually controllable.)
                       If false, use the corresponding namelist value inf_sd_initial.
                       Default: (/.false., .false /)</TD></TR>

<TR><!--contents--><TD valign=top>inf_output_restart</TD>
    <!--  type  --><TD valign=top>logical array (len=2)</TD>
    <!--descript--><TD>Output an inflation restart file if true. 
                       Default: (/.false., .false./)</TD></TR>

<TR><!--contents--><TD valign=top>inf_deterministic</TD>
    <!--  type  --><TD valign=top>logical array (len=2)</TD>
    <!--descript--><TD>True means determinstic inflation, false means stochastic. 
                       Default: (/.true., .true./)</TD></TR>

<TR><!--contents--><TD valign=top>inf_in_file_name</TD>
    <!--  type  --><TD valign=top>character(len=129) by two</TD>
    <!--descript--><TD>Name from which to read inflation restart. 
                       Default: (/'not_initialized', 'not_initialized'/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_out_file_name</TD>
    <!--  type  --><TD valign=top>character(len=129) by two</TD>
    <!--descript--><TD>File to which to write inflation restart file. 
                       Default: (/'not_initialized', 'not_initialized'/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_diag_file_name</TD>
    <!--  type  --><TD valign=top>character(len=129) by two</TD>
    <!--descript--><TD>File to which to write output diagnostics for observation 
                       space inflation. 
                       Default: (/'not_initialized', 'not_initialized'/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_initial</TD>
    <!--  type  --><TD valign=top>real(r8) (len=2)</TD>
    <!--descript--><TD>Initial value of inflation if not read from restart file. 
                       Default: (/1.0_r8, 1.0_r8/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_sd_initial</TD>
    <!--  type  --><TD valign=top>real(r8) (len=2)</TD>
    <!--descript--><TD>Initial value of inflation standard deviation if not read 
                       from restart file.  If negative, do not update the inflation
                       values, so they are time-constant.  If positive, the inflation
                       values will adapt through time, so they are time-varying.
                       Default: (/0.0_r8, 0.0_r8/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_damping</TD>
    <!--  type  --><TD valign=top>real(r8) (len=2)</TD>
    <!--descript--><TD>Damping factor for inflation mean values.
                       The difference between the current inflation value and 1.0
                       is multiplied by this factor before the next assimilation cycle.
                       The value should be between 0.0 and 1.0.
                       0.0 turns all inflation off (by clamping the inflation value to 1.0).
                       1.0 turns inflation damping off (leaving the original inflation
                       value unchanged).
                       Default: (/1.0_r8, 1.0_r8/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_lower_bound</TD>
    <!--  type  --><TD valign=top>real(r8) (len=2)</TD>
    <!--descript--><TD>Lower bound for inflation value.
                       Default: (/1.0_r8, 1.0_r8/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_upper_bound</TD>
    <!--  type  --><TD valign=top>real(r8) (len=2)</TD>
    <!--descript--><TD>Upper bound on inflation value.
                       Default: (/1000000.0_r8, 1000000.0_r8/)</TD></TR>

<TR><!--contents--><TD valign=top>inf_sd_lower_bound</TD>
    <!--  type  --><TD valign=top>real(r8) (len=2)</TD>
    <!--descript--><TD>Lower bound for inflation standard deviation. 
                       If using a negative value for sd_initial, this should also
                       be negative to preserve the setting.
                       Default: (/0.0_r8, 0.0_r8/)</TD></TR>
</TABLE>

<H4 class=indent1>Deprecated or Defunct namelist variables</H4>
<P>The following table contains the deprecated or defunct namelist variables.
   It is a FATAL ERROR to have these in the filter namelist.
</P>
<TABLE border=0 cellpadding=3 width=100%>
<TR><TH align=left>Contents    </TH>
    <TH align=left>Type        </TH>
    <TH align=left>Description </TH></TR>

<TR><!--contents--><TD valign=top>output_state_ens_mean</TD>
    <!--  type  --><TD><b>defunct</b></TD>
    <!--descript--><TD>The ensemble mean is now always in the 
                       state diagnostic output.</TD></TR>

<TR><!--contents--><TD valign=top>output_state_ens_spread</TD>
    <!--  type  --><TD><b>defunct</b></TD>
    <!--descript--><TD>The ensemble spread is now always in the
                       state diagnostic output.</TD></TR>

<TR><!--contents--><TD valign=top>output_obs_ens_mean</TD>
    <!--  type  --><TD><b>defunct</b></TD>
    <!--descript--><TD>The ensemble mean is now always in the 
                       output observation sequence file.</TD></TR>

<TR><!--contents--><TD valign=top>output_obs_ens_spread</TD>
    <!--  type  --><TD><b>defunct</b></TD>
    <!--descript--><TD>The ensemble spread is now always in the 
                       output observation sequence file.</TD></TR>

<TR><!--contents--><TD valign=top>inf_start_from_restart</TD>
    <!--  type  --><TD><b>defunct</b></TD>
    <!--descript--><TD>The mean and standard deviation now have separate
                       namelist controls.</TD></TR>
</TABLE>

</div>
<br>

<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<HR>
<H2>FILES</H2>
<UL><LI>observation sequence input file; from obs_sequence_in_name</LI>
    <LI>output state space prior diagnostics file; Prior_Diag.nc</LI>
    <LI>output state space posterior diagnostics file; Posterior_Diag.nc</LI>
    <LI>output observation space diagnostic file; from obs_sequence_out_name</LI>
    <LI>filter.nml in input.nml</LI>
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<HR>
<H2>REFERENCES</H2>
<ul>
<li>Anderson,&nbsp;J.,&nbsp;T.&nbsp;Hoar,&nbsp;K.&nbsp;Raeder,
    H.&nbsp;Liu,&nbsp;N.&nbsp;Collins,&nbsp;R.&nbsp;Torn,
    and&nbsp;A.&nbsp;Arellano,&nbsp;2009:<br>
    The Data Assimilation Research Testbed: A Community Facility. 
    <span style="font-style: italic;">Bull. Amer. Meteor. Soc.</span>,
    <span style="font-weight: bold;">90</span>, 1283-1296.<br>
    <a href="http://ams.allenpress.com/perlserv/?doi=10.1175%2F2009BAMS2618.1&request=get-abstract">DOI: 10.1175/2009BAMS2618.1</a></li>
</ul>
<br>

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!--==================================================================-->

<A NAME="Errors"></A>
<HR>
<H2>ERROR CODES and CONDITIONS</H2>
<div class=errors>
<TABLE border=1 cellspacing=1 cellpadding=10 width=100%>
<TR><TH>Routine</TH><TH>Message</TH><TH>Comment</TH></TR>

<TR><!-- routine --><TD VALIGN=top>filter_main</TD>
    <!-- message --><TD VALIGN=top>ens_size in namelist is ###: Must be &gt; 1</TD>
    <!-- comment --><TD VALIGN=top>Ensemble size must be at least 2. </TD></TR>

<TR><!-- routine --><TD VALIGN=top>filter_main</TD>
    <!-- message --><TD VALIGN=top>inf_flavor= ### Must be 0, 1, 2, 3.</TD>
    <!-- comment --><TD VALIGN=top>Only inflation options 0 to 3 are supported. </TD></TR>

<TR><!-- routine --><TD VALIGN=top>filter_main</TD>
    <!-- message --><TD VALIGN=top>Posterior observation space inflation (type 1) not supported.</TD>
    <!-- comment --><TD VALIGN=top>Posterior observation space inflation doesn't work. </TD></TR>

<TR><!-- routine --><TD VALIGN=top>filter_main</TD>
    <!-- message --><TD VALIGN=top>Number of processes &gt; model size.</TD>
    <!-- comment --><TD VALIGN=top>Number of processes can't exceed model size for now. </TD></TR>

<TR><!-- routine --><TD VALIGN=top>filter_generate_copy_meta_data</TD>
    <!-- message --><TD VALIGN=top>output metadata in filter needs state ensemble size &lt; 10000, not ###.</TD>
    <!-- comment --><TD VALIGN=top>Only up to 10000 ensemble members with state output for now. </TD></TR>

<TR><!-- routine --><TD VALIGN=top>filter_generate_copy_meta_data</TD>
    <!-- message --><TD VALIGN=top>output metadata in filter needs obs ensemble size &lt; 10000, not ###.</TD>
    <!-- comment --><TD VALIGN=top>Only up to 10000 ensemble members with obs space output for now. </TD></TR>

<TR><!-- routine --><TD VALIGN=top>filter_setup_obs_sequence</TD>
    <!-- message --><TD VALIGN=top>input obs_seq file has ### qc fields; must be &lt; 2.</TD>
    <!-- comment --><TD VALIGN=top>Only 0 or 1 qc fields in input obs sequence for now. </TD></TR>

<TR><!-- routine --><TD VALIGN=top>get_obs_copy_index</TD>
    <!-- message --><TD VALIGN=top>Did not find observation copy with metadata observation.</TD>
    <!-- comment --><TD VALIGN=top>Only 0 or 1 qc fields in input obs sequence for now. </TD></TR>

</TABLE>
</div>

<H2>KNOWN BUGS</H2>
<P>
none
</P>

<!--==================================================================-->
<!-- Describe Future Plans.                                           -->
<!--==================================================================-->

<A NAME="FuturePlans"></A>
<HR>
<H2>FUTURE PLANS</H2>
<P>
Further development to better support observations that can only be
computed once is needed.
</P>

<!--==================================================================-->
<!-- Legalese & Metadata                                              -->
<!--==================================================================-->

<A NAME="Legalese"></A>
<HR>
<H2>Terms of Use</H2>

<P>
DART software - Copyright &#169; 2004 - 2010 UCAR.<br>
This open source software is provided by UCAR, "as is",<br>
without charge, subject to all terms of use at<br>
<a href="http://www.image.ucar.edu/DAReS/DART/DART_download">
http://www.image.ucar.edu/DAReS/DART/DART_download</a>
</P>

<TABLE border=0 cellpadding=0 width=100% summary="">
<TR><TD valign=top>Contact:       </TD><TD> DART core group   </TD></TR>
<TR><TD valign=top>Revision:      </TD><TD> $Revision$ </TD></TR>
<TR><TD valign=top>Source:        </TD><TD> $URL$ </TD></TR>
<TR><TD valign=top>Change Date:   </TD><TD> $Date$ </TD></TR>
<TR><TD valign=top>Change&nbsp;history:&nbsp;</TD><TD> try "svn&nbsp;log" or "svn&nbsp;diff" </TD></TR>
</TABLE>

<!--==================================================================-->

</BODY>
</HTML>
