<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<HTML>
<HEAD>
<TITLE>program create_real_obs</TITLE>
<link rel="stylesheet" type="text/css" href="../../../doc/html/doc.css" />
</HEAD>
<BODY>
<A NAME="TOP"></A>

<H1>PROGRAM create_real_obs</H1>

<table border=0 summary="" cellpadding=5>
<tr>
    <td valign=middle>
    <img src="../../../doc/html/Dartboard7.png" alt="DART project logo" height=70 />
    </td>
    <td>
       <P>Jump to <a href="../../../index.html">DART Documentation Main Index</a><br />
          <small><small>version information for this file: <br />
          <!-- version tag follows, do not edit -->
          $Id$</small></small>
       </P></td>
</tr>
</table>

<A HREF="#Instructions">INSTRUCTIONS</A> / 
<A HREF="#Namelist">NAMELIST</A> /
<A HREF="#Modules">MODULES</A> /
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#FuturePlans">PLANS</A> /
<A HREF="#PrivateComponents">PRIVATE COMPONENTS</A> /
<A HREF="#Legalese">TERMS OF USE</A>

<H2>Overview</H2>

<P>
   Translating NCEP BUFR files into DART obs_seq.out files 
   (input file to filter) is a 2 stage process.  
   The first stage uses NCEP software to translate the BUFR file into 
   an "intermediate" text file.
   This is described in <A HREF="prep_bufr/prep_bufr.html" >prep_bufr</A>.
   The second step is to translate the intermediate files into an 
   <em class=file>obs_seq.out</em> files, which is done by 
   <em class=program>create_real_obs</em>, as described in this document.
</P>

<P>
   This program provides a number of options to select several observation 
   types (radiosonde, aircraft, and satellite data, etc.) and the DART 
   observation variables (U, V, T, Q, Ps) which are specified in its 
   optional namelist interface
   <A HREF="#Namelist"> <em class=code>&amp;ncepobs_nml</em> </A>
   which may be read from file <em class=file>input.nml</em>.
</P>


<!--==================================================================-->

<A NAME="Instructions"></A>
<HR />
<H2>INSTRUCTIONS</H2>

<UL>
<LI> Go to DART/observations/NCEP/ascii_to_obs/work </LI>
<LI> Use <em class=program>quickbuild.csh</em> to compile all executable
     programs in the directory.  To rebuild just one program:
<UL>
<LI> Use <em class=program>mkmf_create_real_obs</em> to generate the 
     makefile to compile <em class=file>create_real_obs.f90</em>.</LI>
<LI> Type <em class=unix>make</em> to get the executable. </LI>
</UL>

<LI> Make appropriate changes to the <em class=code>&amp;ncep_obs_nml</em>
     <A HREF="#Namelist">namelist</A> in <em class=file>input.nml</em>, 
     as follows. </LI>
<LI> run <em class=program>create_real_obs</em>. </LI>
</UL>

<P>
The selection of any combinations of the specific observation fields 
(T, Q, U/V, and surface pressure) and types 
(radiosonde, aircraft reports, or satellite wind, etc.) is made in 
the namelist <em class=code>&amp;ncepobs_nml</em>. 
All the available combinations of fields X types (i.e. ADPUPA and obs_U) 
will be written to the obs_seq file.
(You will be able to select which of those to use during an assimilation in 
another namelist (<em class=code>assimilate_these_obs</em>, 
in <em class=code>&amp;obs_kind_nml</em>), 
so be sure to include all the fields and types you might want.)
You should change <em class=code>Obsbase</em> to the pathname of the 
decoded PREPBUFR text data files. 
Be sure that <em class=code>daily_file</em> is set to .TRUE. to create
a single 24 hour file; .FALSE. converts input files one-for-one with
output files.
The default action is to tag each observation with the exact time it was
taken and is the recommended setting.  However, if you want to bin the 
observations in time, for example to do additional post-processing, 
the time on all observations in the window
can be overwritten and set to the nearest synoptic 
time (e.g. 0Z, 6Z, 12Z, or 18Z), 
by setting <em class=code>obs_time</em> to false.
</P>

<P>
The default namelist values are:
</P>
<PRE>
&amp;ncepobs_nml
   year       = 2003,
   month      = 1,
   day        = 1,
   tot_days   = 31,
   max_num    = 800000,
   select_obs = 0,
   ObsBase    = 'temp_obs.',
   include_specific_humidity = .true.,
   include_relative_humidity = .false.,
   include_dewpoint = .false.,
   ADPUPA     = .false.,
   AIRCAR     = .false.,
   AIRCFT     = .false.,
   SATEMP     = .false.,
   SFCSHP     = .false.,
   ADPSFC     = .false.,
   SATWND     = .false.,
   obs_U      = .false.,
   obs_V      = .false.,
   obs_T      = .false.,
   obs_PS     = .false.,
   obs_QV     = .false.,
   daily_file = .true.,
   obs_time   = .true.,
   lon1       =   0.0,
   lon2       = 360.0,
   lat1       = -90.0,
   lat2       =  90.0  /
</PRE>
<P>
but generally you will want to customize this for your own use.
For example, here is a sample namelist:
</P>
<PRE>
&amp;ncepobs_nml
  year = 2007, 
  month = 3,
  day = 1,
  tot_days = 31,
  max_num = 700000,
  ObsBase = '../prep_bufr/work/temp_obs.'
  select_obs  = 1,
  ADPUPA = .true., 
  AIRCAR = .false.,  
  AIRCFT = .true., 
  SATEMP = .false., 
  SFCSHP = .false.,
  ADPSFC = .false.,  
  SATWND = .true., 
  obs_U  = .true., 
  obs_V  = .true.,
  obs_T  = .true.,
  obs_PS = .false.,
  obs_QV = .false.,
  daily_file = .true.
  obs_time = .true.,
/
&amp;obs_sequence_nml
  write_binary_obs_sequence = .true.  /
</PRE>

<P>
This will produce daily observation sequence files for the period of 
March 2007, which have the selected observation types and fields; 
T, U, and V from radiosondes (ADPUPA) and aircraft (AIRCFT).  
No surface pressure or specific humidity would appear in the obs_seq files,
nor observations from ACARS, satellites, and surface stations.
The output files look like "obs_seq200703dd", with dd = 1,...,31.
</P>

<!--==================================================================-->
<!--=================== DESCRIPTION OF A NAMELIST  ===================-->
<!--==================================================================-->

<A NAME="Namelist"></A>
<HR />
<H2>NAMELIST</H2>
<P>We adhere to the F90 standard of starting a namelist with an ampersand 
'&amp;' and terminating with a slash '/' for all our namelist input.
<div class=namelist><pre>
<em class=call>namelist / ncepobs_nml / </em> &amp;
      year, month, day, tot_days, max_num, select_obs, ObsBase,  &amp;
      include_specific_humidity, include_relative_humidity, include_dewpoint, &amp;
      ADPUPA, AIRCAR, AIRCFT, SATEMP, SFCSHP, ADPSFC, SATWND, &amp;
      obs_U, obs_V, obs_T, obs_PS, obs_QV, lat1, lat2, lon1, lon2, obs_time
</pre>
</div>

<div class=indent1>
<!-- Description -->

<P>
This namelist is read in a file called <em class=file>input.nml</em>
</P>

<TABLE border=0 cellpadding=3 width=100%>
<TR><TH align=left>Contents    </TH>
    <TH align=left>Type        </TH>
    <TH align=left>Description </TH></TR>

<TR><!--contents--><TD valign=top>year, month, day             </TD>
    <!--  type  --><TD valign=top>integer                      </TD>
    <!--descript--><TD valign=top>Beginning day of the preferred 
                       observation period.</TD></TR> 

<TR><!--contents--><TD valign=top> tot_days     </TD>
    <!--  type  --><TD valign=top>integer       </TD>
    <!--descript--><TD>Total days of the preferred observation period.</TD></TR>  

<TR><!--contents--><TD valign=top> max_num      </TD>
    <!--  type  --><TD valign=top>integer       </TD>
    <!--descript--><TD>Maximum observation number for the current one 
                       day files. Default is 800000. </TD></TR>  

<TR><!--contents--><TD valign=top>select_obs    </TD>
    <!--  type  --><TD valign=top>integer       </TD>
    <!--descript--><TD>Controls whether to select a subset of observations 
                       from the NCEP BUFR decoded daily ascii files. <BR />
                       0 = All observations are selected. Default.<BR /> 
                       1 = Select observations using the logical parameters 
                       below.</TD></TR>

<TR><!--contents--><TD valign=top>daily_file    </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Controls timespan of observations in each 
                       obs_seq file:
                       <UL><LI>true = 24 hour spans (3:01Z to 3:00Z of 
		               the next day). Filenames have the form 
			       obs_seqYYYYMMDD.  Default.</LI>
		           <LI>false = 6 hour spans (3:01Z to 9:00Z,
                               9:01Z to 15:00Z, 15:01Z to 21:00Z, 
			       and 21:01Z to 3:00Z of the next day.
			       Such files have HH = 06, 12, 18, and 24 
                               appended to their names.</LI>
		       </UL>
                       </TD></TR>

<TR><!--contents--><TD valign=top>ObsBase             </TD>
    <!--  type  --><TD valign=top>character(len=129)  </TD>
    <!--descript--><TD>Path that contains the decoded NCEP BUFR daily
                        observation files.  Must end with a '/temp_obs.'
                       </TD></TR>

<TR><!--contents--><TD valign=top>include_specific_humidity, include_relative_humidity, include_dewpoint</TD>
    <!--  type  --><TD valign=top>logical </TD>
    <!--descript--><TD>Controls which moisture observations are created.  The default
                       is to create only specific humidity obs, but any, all, or none can
                       be requested.  Set to .TRUE. to output that obs type, .FALSE.
                       skips it. </TD></TR>

<TR><!--contents--><TD valign=top>ADPUPA        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select the NCEP type ADPUPA observations 
                       which includes land and ship launched radiosondes 
                       and pibals as well as a few  profile dropsonde. This 
                       involves,  at 00Z and 12Z, about 650 - 1000 stations,
                       and at 06Z and 18Z  (which are mostly pibals), about 
                       150 - 400 stations. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>AIRCFT        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select the NCEP type AIRCFT observations, which 
                       includes commercial, some military and 
                       reconnaissance reports. They are flight level reports. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>AIRCAR        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select the NCEP type AIRCAR observations, which 
                       includes data from aircraft takeoff and landings. 
		       Sometimes referred to as ACARS obs.
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>SATEMP        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select the NCEP type SATEMP observations, 
                       which includes NESDIS ATOVS virtual temperature 
		       soundings. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>SFCSHP        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select the NCEP type SFCSHP observations, which 
                       includes surface marine (ship, buoy, c-man) reports. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>ADPSFC        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select the NCEP type ADPSFC observations, 
                       which includes surface land synoptic station reports. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>SATWND        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select the NCEP type SATWND observations, 
                       which includes winds derived from satellite cloud 
                       drift analysis.  Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>obs_U         </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select u-component of wind observation. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>obs_V         </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select v-component of wind observation. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>obs_T         </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select temperature observation. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>obs_PS        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select surface pressure observation. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>obs_QV        </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Select specific humidity observation. 
                       Default is .false.</TD></TR>

<TR><!--contents--><TD valign=top>lon1          </TD>
    <!--  type  --><TD valign=top>real          </TD>
    <!--descript--><TD>lower longitude bound of observations to keep
                       Default is 0.0</TD></TR>

<TR><!--contents--><TD valign=top>lon2          </TD>
    <!--  type  --><TD valign=top>real          </TD>
    <!--descript--><TD>upper longitude bound of observations to keep
                       Default is 360.0</TD></TR>

<TR><!--contents--><TD valign=top>lat1          </TD>
    <!--  type  --><TD valign=top>real          </TD>
    <!--descript--><TD>lower latitude bound of observations to keep
                       Default is -90.0</TD></TR>

<TR><!--contents--><TD valign=top>lat2          </TD>
    <!--  type  --><TD valign=top>real          </TD>
    <!--descript--><TD>upper latitude bound of observations to keep
                       Default is 90.0</TD></TR>

<TR><!--contents--><TD valign=top>obs_time      </TD>
    <!--  type  --><TD valign=top>logical       </TD>
    <!--descript--><TD>Use the full time in the input data for the time
                       of the output observation.  To bin all observations
                       in the window and give them the same synoptic time 
                       (e.g. 0Z, 6Z, 12Z, or 18Z), set this to false.
                       Default is .true.</TD></TR>

</TABLE>

</div>
<br />

<!--==================================================================-->

<A NAME="Modules"></A>
<HR />
<H2>MODULES USED</H2>
<PRE>
types_mod
utilities_mod
obs_utilities_mod
obs_sequence_mod
obs_kind_mod
obs_def_mod
assim_model_mod
model_mod
cov_cutoff_mod
location_mod
random_seq_mod
random_nr_mod
time_manager_mod
null_mpi_utilities_mod
real_obs_mod
</PRE>

<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<HR />
<H2>FILES</H2>
<UL>
    <LI> path_names_create_real_obs; the list of modules used in the
         compilation of create_real_obs. </LI>
    <LI> temp_obs.yyyymmdd; (input) NCEP BUFR (decoded/intermediate) 
         observation file(s) Each one has 00Z of the next day on it.</LI>
    <LI> input.nml; the namelist file used by create_real_obs. </LI>
    <LI> obs_seqYYYYMMDD[HH]; (output) the obs_seq files used by DART. </LI>
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<HR />
<H2>REFERENCES</H2>
<ul>
<li>.../DART/observations/NCEP/prep_bufr/docs/* 
    (NCEP text files describing the BUFR files)</li>
</ul>

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!--==================================================================-->

<A NAME="Errors"></A>
<HR />
<H2>ERROR CODES and CONDITIONS</H2>
<div class=errors>
<TABLE border=1 cellspacing=1 cellpadding=10 width=100%>
<TR><TH>Routine</TH><TH>Message</TH><TH>Comment</TH></TR>

<TR><!-- routine --><TD VALIGN=top>&nbsp;</TD>
    <!-- message --><TD VALIGN=top>&nbsp;</TD>
    <!-- comment --><TD VALIGN=top>&nbsp;</TD></TR>

</TABLE>
</div>

<H2>KNOWN BUGS</H2>
<P>
none
</P>

<!--==================================================================-->
<!-- Describe Future Plans.                                           -->
<!--==================================================================-->

<A NAME="FuturePlans"></A>
<HR />
<H2>FUTURE PLANS</H2>
<P>
Further development to get observations directly from original <BR />
(undecoded) NCEP BUFR files.
</P>

<!--==================================================================-->
<!-- Legalese & Metadata                                              -->
<!--==================================================================-->

<A NAME="Legalese"></A>
<HR />
<H2>Terms of Use</H2>

<P>
DART software - Copyright 2004 - 2011 UCAR.<br />
This open source software is provided by UCAR, "as is",<br />
without charge, subject to all terms of use at<br />
<a href="http://www.image.ucar.edu/DAReS/DART/DART_download">
http://www.image.ucar.edu/DAReS/DART/DART_download</a>
</P>

<TABLE border=0 cellpadding=0 width=100% summary="">
<TR><TD valign=top>Contact:       </TD><TD> DART core group   </TD></TR>
<TR><TD valign=top>Revision:      </TD><TD> $Revision$ </TD></TR>
<TR><TD valign=top>Source:        </TD><TD> $URL$ </TD></TR>
<TR><TD valign=top>Change Date:   </TD><TD> $Date$ </TD></TR>
<TR><TD valign=top>Change&nbsp;history:&nbsp;</TD><TD> try "svn&nbsp;log" or "svn&nbsp;diff" </TD></TR>
</TABLE>

<!--==================================================================-->

</BODY>
</HTML>
