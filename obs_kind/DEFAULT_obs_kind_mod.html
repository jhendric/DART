<HTML>
<HEAD>
<TITLE>module DEFAULT_obs_def_kind</TITLE>
<link rel="stylesheet" type="text/css" href="../doc/html/doc.css"></link> 
</HEAD>
<BODY>
<!--
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!                                                                       !!
!!                   GNU General Public License                          !!
!!                                                                       !!
!! This file is part of the Data Assimilation Research Testbed (DART).   !!
!!                                                                       !!
!! DART is free software; you can redistribute it and/or modify          !!
!! it and are expected to follow the terms of the GNU General Public     !!
!! License as published by the Free Software Foundation.                 !!
!!                                                                       !!
!! DART is distributed in the hope that it will be useful,               !!
!! but WITHOUT ANY WARRANTY; without even the implied warranty of        !!
!! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         !!
!! GNU General Public License for more details.                          !!
!!                                                                       !!
!! You should have received a copy of the GNU General Public License     !!
!! along with DART; if not, write to:                                    !!
!!          Free Software Foundation, Inc.                               !!
!!          59 Temple Place, Suite 330                                   !!
!!          Boston, MA  02111-1307  USA                                  !!
!! or see:                                                               !!
!!          http://www.gnu.org/licenses/gpl.txt                          !!
!!                                                                       !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-->

<H1>MODULE DEFAULT_obs_def_kind</H1>
<A NAME="HEADER"></A>

<!--==================================================================-->

<A NAME="OVERVIEW"></A>
<HR>
<H2>OVERVIEW</H2>

Beginning with the I-release of DART, a more flexible, powerful (and
complicated) mechanism for incorporating new types of observations is part of
DART. The DEFAULT_obs_kind module being described here is used by the program
<em class="unix">preprocess</em>
to create the 
<em class="file">obs_kind_mod.f90</em> (documented separately in this
directory).  Information from zero or more special obs_def modules (such as
<em class="file">obs_def_1d_state_mod.f90</em> or 
<em class="file">obs_def_reanalysis_bufr_mod.f90</em>,
documented in the obs_def directory) are incorporated into the template
provided by DEFAULT_obs_def_kind. If no special obs_def files are included in
the preprocessor namelist, a minimal 
<em class="file">obs_kind_mod.f90</em> is created which can
only support identity forward observation operators.
</P>
<P> 
To add a new specific observation type, see the
<a href="../obs_def/obs_def_mod.html">obs_def_mod</a> documentation.
If adding this type includes defining a new generic observation kind,
then the kind must be added to the table in this file, with a unique
integer value defined for it.
In a planned future update to the preprocess program it is expected that
this kinds table will become autogenerated, much like the types table
described below, so no editing of this file will be needed.  But until then,
kinds must be added by here, by hand. And note that they must be added
to the template file, <em class="file">DEFAULT_obs_kind_mod.F90</em> and
not the output of the preprocess program, 
<em class="file">obs_kind_mod.f90</em>.  The latter file is overwritten
each time preprocess runs, deleting any hand editing done on that file.
</P>
<P> 
The rest of this documentation 
describes the special formatting that is included
in the DEFAULT_obs_kind_mod in order to guide the preprocess program. Two
sections of code are inserted into the DEFAULT_obs_def_kind module from each of
the special obs_def modules that are requested. The insertion point for each
section is denoted by a special comment line that must be included VERBATIM
in DEFAULT_obs_kind_mod. These special comment lines and their significance are:
<OL>
<li> <pre>
! DART PREPROCESS INTEGER DECLARATION INSERTED HERE
</pre>
Each of the observation type identifiers are inserted here, and are given
both the <em class="unix">parameter</em> and <em class="unix">public</em>
attributes. 
The associated integer values are generated sequentially, starting at 1.
If a different set of special obs_def modules is specified via the
namelist for preprocess, the integer value associated with a given observation
type could change so these integers are for use internal to a given program
execution only. Observation types are permanently and uniquely identified by
a string with character values identical to the integer identifier here. In
other words, an observation kind with integer parameter identifier 
RAW_STATE_VARIABLE will always be associated with a string 
"RAW_STATE_VARIABLE" (see below).
</li>

<li> <pre>
! DART PREPROCESS OBS_KIND_INFO INSERTED HERE
</pre>
The entries for the obs_kind_info table are initialized here. This table has a
row for each observation kind defined in the public and integer parameter
declarations discussed above. For each obs_kind, the obs_kind info table
contains the following information:
<ol>
<li>The integer index associated with this
observation kind. This is the value that is defined in the integer parameter
statement above. 
</li>
<li>A character string with maximum length 32 characters
that uniquely identifies the observation kind. This string is identical to the
F90 identifier used in the integer parameter statements created above.
</li>
<li>A generic variable type referenced by an integer. The
obs_kind_mod contains a table that defines an integer parameter that uniquely
identifies each generic observation kind. Generic kinds can be associated with
both a model state variable or an observation kind. For instance, the generic
kind U_WIND_COMPONENT might be associated with model U state variables, with
RADIOSONDE_U_WIND_COMPONENT observation kinds, and with ACARS_U_WIND_COMPONENT
observation kinds. The distinction between generic kinds and observation types
is important and potentially confusing, so be careful to understand this
point. 
</li>
<li>A logical variable indicating whether observations of this kind are
to be assimilated in the current experiment. This variable is set from the
obs_kind namelist (see obs_kind_mod.html in this directory).  
The default value here is false when the obs_def_mod is
created by the preprocess program.
</li>
<li>A logical
variable indicating whether observations of this kind are to be evaluated
(forward operator computed and recorded) but not assimilated (again set by
namelist).
The default value here is false when the obs_def_mod is
created by the preprocess program.
</li>
</ol>
</li>

</ol>
<P>

<P>


<HR>
<TABLE summary="">
<TR><TD>Contact:       </TD><TD> Jeff Anderson     </TD></TR>
<TR><TD>Revision:      </TD><TD> $Revision$ </TD></TR>
<TR><TD>Source:        </TD><TD> $URL$ </TD></TR>
<TR><TD>Change Date:   </TD><TD> $Date$ </TD></TR>
<TR><TD>Change history:</TD><TD> try "svn log" or "svn diff" </TD></TR>
</TABLE>

<BR>

<!--==================================================================-->

<!--==================================================================-->
